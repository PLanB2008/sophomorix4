#!/usr/bin/perl -w
# This script (sophomorix-test-4) is maintained by Rüdiger Beck
# It is Free Software (License GPLv3)
# If you find errors, contact the author
# jeffbeck@web.de  or  jeffbeck@linuxmuster.net

# Bibliotheken
use strict;
use Getopt::Long;
Getopt::Long::Configure ("bundling");
use Sophomorix::SophomorixBase qw(
                                 print_line
                                 print_title
                                 check_options
                                 time_stamp_AD 
                                 get_passwd_charlist
                                 get_plain_password
                                 );
use Sophomorix::SophomorixSambaAD qw(
                                 AD_school_add
                                 AD_bind_admin
                                 AD_unbind_admin
                                 AD_user_create
                                 AD_group_create
                                 AD_group_addmember
                                 AD_user_kill
                                 AD_dns_get
                                 AD_object_search
                                 AD_debug_logdump
                                 AD_get_name_tokened
                                    );
use Sophomorix::SophomorixTest qw(
                                 AD_object_nonexist
                                 AD_test_object
                                 run_command
                                 );

$Conf::log_level=1;
my $help=0;
my $full=0;
my $add_class=0;
my $test_add_class=0;

my $mod_class=0;
my $test_mod_class=0;

my $kill_class=0;
my $test_kill_class=0;

my $verbose_options="";

my $testopt=GetOptions(
           "help|h" => \$help,
           "full|f" => \$full,
           "verbose|v+" => \$Conf::log_level,
           "add-class" => \$add_class,
           "test-add-class" => \$test_add_class,
           "mod-class" => \$mod_class,
           "test-mod-class" => \$test_mod_class,
           "kill-class" => \$kill_class,
           "test-kill-class" => \$test_kill_class,
  );


# Prüfen, ob Optionen erkannt wurden, sonst Abbruch
&check_options($testopt);



if ($Conf::log_level==1){
    $verbose_options="";
} elsif ($Conf::log_level==2){
    $verbose_options="-v";
} elsif ($Conf::log_level==3){
    $verbose_options="-vv";
}




my ($ldap,$root_dse) = &AD_bind_admin();
my $root_dns=&AD_dns_get($root_dse);

my $testdata="/usr/share/sophomorix-developer/testdata";


# --help
if ($help==1) {
   # Scriptname ermitteln
   my @list = split(/\//,$0);
   my $scriptname = pop @list;
   # Befehlsbeschreibung
   print('
sophomorix-test-4 tests the addition of ExamAccounts and workstation accounts.

Options
  -h  / --help

  Classes:
  sophomorix-test-4 --add-class  
    add some classes
  sophomorix-test-4 --test-add-class
    test the added classes

  sophomorix-test-4 --mod-class
    modify added classes
  sophomorix-test-4 --test-mod-class
    test modified classes

  sophomorix-test-4 --kill-class
    kill all added classes
  sophomorix-test-4 --test-kill-class
    test killed classes

');
   print "\n";
   exit;
}





############################################################
# Check preliminaries
############################################################

# --full
if ($full==1){
    $add_class=1;
    $mod_class=1;
    $kill_class=1;
    $test_add_class=1;
    $test_mod_class=1;
    $test_kill_class=1;
}

my $file_add_test=$testdata."/sophomorix.add-40";
my $file_add=$DevelConf::path_result."/sophomorix.add";
my $file_kill=$DevelConf::path_result."/sophomorix.kill";
my $file_kill_test=$testdata."/sophomorix.kill-40";


############################################################
# Add classes
############################################################
# --add-class  
if ($add_class==1){
    # adding users
    &run_command("cp -v $file_add_test $file_add");
    &run_command("sophomorix-add $verbose_options");

    # groups in OU=bsz
    &run_command("sophomorix-class $verbose_options --create --class class6-38 --school bsz");
    &run_command("sophomorix-class $verbose_options --create --class class7-38 --school bsz");
    # groups in OU=default-school
    &run_command("sophomorix-class $verbose_options --create --class class12-38");
    &run_command("sophomorix-class $verbose_options --create --class class13-38");
}

############################################################
# Test added classes
############################################################
# --test-add-class  
if ($test_add_class==1){
    ##### Testing the users
    # maiersa38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa38,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa38",
                   sAMAccountname=>"maiersa38",
                   uidNumber=>"-1",
                   sn=>"Maier",
                   userPrincipalName => "maiersa38@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   memberOf => "bsz-m7ab",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m7ab,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m7ab",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "global-students",
                  });


    # muellegr38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=muellegr38,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Gregor Müller",
                   givenName=>"Gregor",
                   name=>"muellegr38",
                   sAMAccountname=>"muellegr38",
                   uidNumber=>"-1",
                   sn=>"Müller",
                   userPrincipalName => "muellegr38@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster38!",
                   sophomorixFirstnameASCII => "Gregor",
                   sophomorixSurnameASCII  => "Mueller",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   memberOf => "bsz-m7ab",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m7ab,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m7ab",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "global-students",
                  });


    # jonsonad38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=jonsonad38,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Aðalráður Jónsson",
                   givenName=>"Aðalráður",
                   name=>"jonsonad38",
                   sAMAccountname=>"jonsonad38",
                   uidNumber=>"-1",
                   sn=>"Jónsson",
                   userPrincipalName => "jonsonad38@".$root_dns,
                   sophomorixAdminClass => "bsz-m8cd",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster38!",
                   sophomorixFirstnameASCII => "Adalradur",
                   sophomorixSurnameASCII  => "Jonsson",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   memberOf => "bsz-m8cd",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m8cd,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m8cd",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "global-students",
                  });


    # samardze38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=samardze38,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Željko Samardžić",
                   givenName=>"Željko",
                   name=>"samardze38",
                   sAMAccountname=>"samardze38",
                   uidNumber=>"-1",
                   sn=>"Samardžić",
                   userPrincipalName => "samardze38@".$root_dns,
                   sophomorixAdminClass => "bsz-m8cd",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Zeljko",
                   sophomorixSurnameASCII  => "Samardzic",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   memberOf => "bsz-m8cd",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m8cd,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m8cd",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "global-students",
                  });


    # oe38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=oe38,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Gökhan Ömür",
                   givenName=>"Gökhan",
                   name=>"oe38",
                   sAMAccountname=>"oe38",
                   uidNumber=>"-1",
                   sn=>"Ömür",
                   userPrincipalName => "oe38@".$root_dns,
                   sophomorixAdminClass => "bsz-teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster38!",
                   sophomorixFirstnameASCII => "Goekhan",
                   sophomorixSurnameASCII  => "Oemuer",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   memberOf => "bsz-teachers",
                  });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-teachers,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "global-teachers",
                  });


    # wu38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=wu38,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Désirée Würth",
                   givenName=>"Désirée",
                   name=>"wu38",
                   sAMAccountname=>"wu38",
                   uidNumber=>"-1",
                   sn=>"Würth",
                   userPrincipalName => "wu38@".$root_dns,
                   sophomorixAdminClass => "bsz-teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster!",
                   sophomorixFirstnameASCII => "Desiree",
                   sophomorixSurnameASCII  => "Wuerth",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   memberOf => "bsz-teachers",
                  });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-teachers,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "global-teachers",
                  });


    # blackmri38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=blackmri38,OU=12abc,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Richard Blackmore",
                   givenName=>"Richard",
                   name=>"blackmri38",
                   sAMAccountname=>"blackmri38",
                   uidNumber=>"-1",
                   sn=>"Blackmore",
                   userPrincipalName => "blackmri38@".$root_dns,
                   sophomorixAdminClass => "uni-12abc",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Richard",
                   sophomorixSurnameASCII  => "Blackmore",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   memberOf => "uni-12abc",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-12abc,OU=12abc,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-12abc",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "uni-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-students,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "global-students",
                  });


    # lordjo38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=lordjo38,OU=12abc,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Jon Lord",
                   givenName=>"Jon",
                   name=>"lordjo38",
                   sAMAccountname=>"lordjo38",
                   uidNumber=>"-1",
                   sn=>"Lord",
                   userPrincipalName => "lordjo38@".$root_dns,
                   sophomorixAdminClass => "uni-12abc",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster38!",
                   sophomorixFirstnameASCII => "Jon",
                   sophomorixSurnameASCII  => "Lord",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   memberOf => "uni-12abc",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-12abc,OU=12abc,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-12abc",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "uni-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-students,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "global-students",
                  });


    # kep38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=kep38,OU=Teachers,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Johannes Kepler",
                   givenName=>"Johannes",
                   name=>"kep38",
                   sAMAccountname=>"kep38",
                   uidNumber=>"-1",
                   sn=>"Kepler",
                   userPrincipalName => "kep38@".$root_dns,
                   sophomorixAdminClass => "uni-teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster38!",
                   sophomorixFirstnameASCII => "Johannes",
                   sophomorixSurnameASCII  => "Kepler",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   memberOf => "uni-teachers",
                  });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-teachers,OU=Teachers,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "global-teachers",
                  });


    # gal38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=gal38,OU=Teachers,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Galileo Galilei",
                   givenName=>"Galileo",
                   name=>"gal38",
                   sAMAccountname=>"gal38",
                   uidNumber=>"-1",
                   sn=>"Galilei",
                   userPrincipalName => "gal38@".$root_dns,
                   sophomorixAdminClass => "uni-teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster!",
                   sophomorixFirstnameASCII => "Galileo",
                   sophomorixSurnameASCII  => "Galilei",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   memberOf => "uni-teachers",
                  });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-teachers,OU=Teachers,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "global-teachers",
                  });
    # schneima38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=schneima38,OU=s6ade,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Marina Schneider",
                   givenName=>"Marina",
                   name=>"schneima38",
                   sAMAccountname=>"schneima38",
                   uidNumber=>"-1",
                   sn=>"Schneider",
                   userPrincipalName => "schneima38@".$root_dns,
                   sophomorixAdminClass => "s6ade",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Marina",
                   sophomorixSurnameASCII  => "Schneider",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "---",
                   sophomorixSchoolname => "default-school",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   memberOf => "s6ade",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=s6ade,OU=s6ade,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"s6ade",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "students",
                  });
    ##### Testing the users ou-students group    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=students,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   memberOf => "global-students",
                  });
    # sch38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=sch38,OU=Teachers,OU=default-school,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Michael Schäfer",
                   givenName=>"Michael",
                   name=>"sch38",
                   sAMAccountname=>"sch38",
                   uidNumber=>"-1",
                   sn=>"Schäfer",
                   userPrincipalName => "sch38@".$root_dns,
                   sophomorixAdminClass => "teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster!",
                   sophomorixFirstnameASCII => "Michael",
                   sophomorixSurnameASCII  => "Schaefer",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "---",
                   sophomorixSchoolname => "default-school",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   memberOf => "teachers",
                  });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=teachers,OU=Teachers,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"teachers",
                   gidNumber=>"-1",
                   sophomorixHidden=>"FALSE",
                   memberOf => "global-teachers",
                  });

    ##### Testing the global groups
#    &AD_test_object({ldap=>$ldap,
#                   dn=>"CN=global-examaccounts,OU=Groups,OU=GLOBAL,OU=SCHOOLS,".$root_dse,
#                   sAMAccountname=>"global-examaccounts",
#                   gidNumber=>"-1",
#                   sophomorixCreationDate => "exists",
#                   sophomorixStatus=>"P",
#                   sophomorixType=>"adminclass",
#                   sophomorixHidden=>"FALSE",
#                  });
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=global-students,OU=global-students,OU=Groups,OU=GLOBAL,OU=SCHOOLS,".$root_dse,
                   #dn=>"CN=global-students,OU=global-students,OU=Groups,OU=GLOBAL,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"global-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"globalclass",
                   sophomorixHidden=>"FALSE",
                  });
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=global-teachers,OU=global-teachers,OU=Groups,OU=GLOBAL,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"global-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"globalclass",
                   sophomorixHidden=>"FALSE",
                  });

    # groups
    # bsz-class6-38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-class6-38,OU=class6-38,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-class6-38",
                   gidNumber=>"-1",
                   description=>"bsz-class6-38",
                   sophomorixType=>"adminclass",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixCreationDate => "exists",
                   sophomorixHidden=>"FALSE",
                   memberOf => "bsz-students",
                  });
    # bsz-class7-38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-class7-38,OU=class7-38,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-class7-38",
                   gidNumber=>"-1",
                   description=>"bsz-class7-38",
                   sophomorixType=>"adminclass",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixCreationDate => "exists",
                   sophomorixHidden=>"FALSE",
                   memberOf => "bsz-students",
                  });
    # class12-38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"class12-38",
                   sophomorixType=>"adminclass",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixCreationDate => "exists",
                   sophomorixHidden=>"FALSE",
                   memberOf => "students",
                  });
    # class13-38
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class13-38,OU=class13-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class13-38",
                   gidNumber=>"-1",
                   description=>"class13-38",
                   sophomorixType=>"adminclass",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixCreationDate => "exists",
                   sophomorixHidden=>"FALSE",
                   memberOf => "students",
                  });
}




############################################################
# Modify added projects
############################################################
# --mod-class  
if ($mod_class==1){

    # --description
    &run_command("sophomorix-class $verbose_options -c class12-38 --description 'Klasse 12 TG'");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixCreationDate => "exists",
                   sophomorixAdmins => "",
                   sophomorixMembers => "",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"FALSE",
                   member => "",
                   memberOf => "students",
                  });
    # --quota
    &run_command("sophomorix-class $verbose_options -c class12-38 --quota 100+300");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"-1",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixCreationDate => "exists",
                   sophomorixAdmins => "",
                   sophomorixMembers => "",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"FALSE",
                   member => "",
                   memberOf => "students",
                  });

    # --mailquota 
    &run_command("sophomorix-class $verbose_options -c class12-38 --mailquota 897");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"897",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixCreationDate => "exists",
                   sophomorixAdmins => "",
                   sophomorixMembers => "",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"FALSE",
                   member => "",
                   memberOf => "students",
                  });

    # --mailalias
    &run_command("sophomorix-class $verbose_options -c class12-38 --mailalias");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"897",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"TRUE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixCreationDate => "exists",
                   sophomorixAdmins => "",
                   sophomorixMembers => "",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"FALSE",
                   member => "",
                   memberOf => "students",
                  });

    # --maillist
    &run_command("sophomorix-class $verbose_options -c class12-38 --maillist");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"897",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"TRUE",
                   sophomorixMailList=>"TRUE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixCreationDate => "exists",
                   sophomorixAdmins => "",
                   sophomorixMembers => "",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"FALSE",
                   member => "",
                   memberOf => "students",
                  });

    # --status
    &run_command("sophomorix-class $verbose_options -c class12-38 --status S");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"897",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"TRUE",
                   sophomorixMailList=>"TRUE",
                   sophomorixStatus=>"S",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixCreationDate => "exists",
                   sophomorixAdmins => "",
                   sophomorixMembers => "",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"FALSE",
                   member => "",
                   memberOf => "students",
                  });

    # --join
    &run_command("sophomorix-class $verbose_options -c class12-38 --nojoin");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"897",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"TRUE",
                   sophomorixMailList=>"TRUE",
                   sophomorixStatus=>"S",
                   sophomorixJoinable=>"FALSE",
                   sophomorixMaxMembers=>"0",
                   sophomorixCreationDate => "exists",
                   sophomorixAdmins => "",
                   sophomorixMembers => "",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"FALSE",
                   member => "",
                   memberOf => "students",
                  });

    # --hide
    &run_command("sophomorix-class $verbose_options -c class12-38 --hide");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"897",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"TRUE",
                   sophomorixMailList=>"TRUE",
                   sophomorixStatus=>"S",
                   sophomorixJoinable=>"FALSE",
                   sophomorixMaxMembers=>"0",
                   sophomorixCreationDate => "exists",
                   sophomorixAdmins => "",
                   sophomorixMembers => "",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"TRUE",
                   member => "",
                   memberOf => "students",
                  });

    # --maxmembers
    &run_command("sophomorix-class $verbose_options -c class12-38 --maxmembers 16");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"897",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"TRUE",
                   sophomorixMailList=>"TRUE",
                   sophomorixStatus=>"S",
                   sophomorixJoinable=>"FALSE",
                   sophomorixMaxMembers=>"16",
                   sophomorixCreationDate => "exists",
                   sophomorixAdmins => "",
                   sophomorixMembers => "",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"TRUE",
                   member => "",
                   memberOf => "students",
                  });

    # --creationdate
    &run_command("sophomorix-class $verbose_options -c class12-38 --creationdate 19880529093330.0Z");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"897",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"TRUE",
                   sophomorixMailList=>"TRUE",
                   sophomorixStatus=>"S",
                   sophomorixJoinable=>"FALSE",
                   sophomorixMaxMembers=>"16",
                   sophomorixCreationDate => "198",
                   sophomorixAdmins => "",
                   sophomorixMembers => "",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"TRUE",
                   member => "",
                   memberOf => "students",
                  });

    # --admins
    &run_command("sophomorix-class $verbose_options -c class12-38 --admins maiersa38,muellegr38");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"897",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"TRUE",
                   sophomorixMailList=>"TRUE",
                   sophomorixStatus=>"S",
                   sophomorixJoinable=>"FALSE",
                   sophomorixMaxMembers=>"16",
                   sophomorixCreationDate => "198",
                   sophomorixAdmins => "maiersa38|muellegr38",
                   sophomorixMembers => "",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"TRUE",
                   member => "maiersa38|muellegr38",
                   memberOf => "students",
                  });

    # --members
    &run_command("sophomorix-class $verbose_options -c class12-38 --members kep38,wu38");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"897",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"TRUE",
                   sophomorixMailList=>"TRUE",
                   sophomorixStatus=>"S",
                   sophomorixJoinable=>"FALSE",
                   sophomorixMaxMembers=>"16",
                   sophomorixCreationDate => "198",
                   sophomorixAdmins => "maiersa38|muellegr38",
                   sophomorixMembers => "kep38|wu38",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"TRUE",
                   member => "maiersa38|muellegr38|kep38|wu38",
                   memberOf => "students",
                  });
    
    # --addadmins
    &run_command("sophomorix-class $verbose_options -c class12-38 --addadmins lordjo38,blackmri38");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"897",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"TRUE",
                   sophomorixMailList=>"TRUE",
                   sophomorixStatus=>"S",
                   sophomorixJoinable=>"FALSE",
                   sophomorixMaxMembers=>"16",
                   sophomorixCreationDate => "198",
                   sophomorixAdmins => "maiersa38|muellegr38|lordjo38|blackmri38",
                   sophomorixMembers => "kep38|wu38",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"TRUE",
                   member => "maiersa38|muellegr38|kep38|wu38|lordjo38|blackmri38",
                   memberOf => "students",
                  });

    # --addmembers (1 adding to existing value)
    &run_command("sophomorix-class $verbose_options -c class12-38 --addmembers samardze38,schneima38");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"897",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"TRUE",
                   sophomorixMailList=>"TRUE",
                   sophomorixStatus=>"S",
                   sophomorixJoinable=>"FALSE",
                   sophomorixMaxMembers=>"16",
                   sophomorixCreationDate => "198",
                   sophomorixAdmins => "maiersa38|muellegr38|lordjo38|blackmri38",
                   sophomorixMembers => "kep38|wu38|samardze38|schneima38",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"TRUE",
                   member => "maiersa38|muellegr38|kep38|wu38|lordjo38|blackmri38|samardze38|schneima38",
                   memberOf => "students",
                  });
    # --removeadmins (1 adding to existing value)
    &run_command("sophomorix-class $verbose_options -c class12-38 --removeadmins muellegr38,lordjo38");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"897",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"TRUE",
                   sophomorixMailList=>"TRUE",
                   sophomorixStatus=>"S",
                   sophomorixJoinable=>"FALSE",
                   sophomorixMaxMembers=>"16",
                   sophomorixCreationDate => "198",
                   sophomorixAdmins => "maiersa38|blackmri38",
                   sophomorixMembers => "kep38|wu38|samardze38|schneima38",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"TRUE",
                   member => "maiersa38|kep38|wu38|blackmri38|samardze38|schneima38",
                   memberOf => "students",
                  });

    # --removemembers (1 adding to existing value)
    &run_command("sophomorix-class $verbose_options -c class12-38 --removemembers kep38,schneima38");
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"Klasse 12 TG",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"100+300",
                   sophomorixMailQuota=>"897",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"TRUE",
                   sophomorixMailList=>"TRUE",
                   sophomorixStatus=>"S",
                   sophomorixJoinable=>"FALSE",
                   sophomorixMaxMembers=>"16",
                   sophomorixCreationDate => "198",
                   sophomorixAdmins => "maiersa38|blackmri38",
                   sophomorixMembers => "wu38|samardze38",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"TRUE",
                   member => "maiersa38|wu38|blackmri38|samardze38",
                   memberOf => "students",
                  });

    # setting all back in one command
    &run_command("sophomorix-class $verbose_options -c class12-38 --join --nohide --quota --- --mailquota -1 --nomailalias --nomaillist --status P --maxmembers 0 --creationdate 20160529093330.0Z --description 'class12-38' --admins \"\" --members \"\" ");
    # checking if all is set back
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=class12-38,OU=class12-38,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"class12-38",
                   gidNumber=>"-1",
                   description=>"class12-38",
                   sophomorixType=>"adminclass",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixCreationDate => "exists",
                   sophomorixAdmins => "",
                   sophomorixMembers => "",
                   sophomorixAdminGroups => "",
                   sophomorixMemberGroups => "",
                   sophomorixHidden=>"FALSE",
                   member => "",
                   memberOf => "students",
                  });
}

############################################################
#  Test modified  projects
############################################################
# --test-mod-class  
if ($test_mod_class==1){
    print "\nNothing to do so far (--test-mod-class), ...\n\n";
}




############################################################
# Kill projects
############################################################
# --kill-class  
if ($kill_class==1){
    &run_command("cp -v $file_kill_test $file_kill");
    &run_command("sophomorix-kill -i");
    &run_command("sophomorix-kill $verbose_options");
    # groups
    &run_command("sophomorix-class $verbose_options --kill --class class6-38 --school bsz");
    &run_command("sophomorix-class $verbose_options --kill --class class7-38 --school bsz");
    &run_command("sophomorix-class $verbose_options --kill --class class12-38");
    &run_command("sophomorix-class $verbose_options --kill --class class13-38");

}

############################################################
#  Test killed  users, groups, projects
############################################################
# --test-kill-class  
if ($test_kill_class==1){
    # users
    &AD_object_nonexist($ldap,$root_dse,"user","maiersa38");
    &AD_object_nonexist($ldap,$root_dse,"user","muellegr38");
    &AD_object_nonexist($ldap,$root_dse,"user","jonsonad38");
    &AD_object_nonexist($ldap,$root_dse,"user","samardze38");
    &AD_object_nonexist($ldap,$root_dse,"user","oe38");
    &AD_object_nonexist($ldap,$root_dse,"user","wu38");
    &AD_object_nonexist($ldap,$root_dse,"user","lordjo38");
    &AD_object_nonexist($ldap,$root_dse,"user","blackmri38");
    &AD_object_nonexist($ldap,$root_dse,"user","kep38");
    &AD_object_nonexist($ldap,$root_dse,"user","gal38");
    &AD_object_nonexist($ldap,$root_dse,"user","schneima38");
    &AD_object_nonexist($ldap,$root_dse,"user","sch38");

    # groups
    &AD_object_nonexist($ldap,$root_dse,"group","bsz-class6-38");
    &AD_object_nonexist($ldap,$root_dse,"group","bsz-class7-38");
    &AD_object_nonexist($ldap,$root_dse,"group","class12-38");
    &AD_object_nonexist($ldap,$root_dse,"group","class13-38");
}






&AD_unbind_admin($ldap);



