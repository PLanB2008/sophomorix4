#!/usr/bin/perl -w
# This script (sophomorix-test-1) is maintained by Rüdiger Beck
# It is Free Software (License GPLv3)
# If you find errors, contact the author
# jeffbeck@web.de  or  jeffbeck@linuxmuster.net

# Bibliotheken
use strict;
use Getopt::Long;
Getopt::Long::Configure ("bundling");
use Sophomorix::SophomorixBase qw(
                                 print_line
                                 print_title
                                 check_options
                                 );
use Sophomorix::SophomorixSambaAD qw(
                                 AD_bind_admin
                                 AD_unbind_admin
                                 AD_dns_get
                                 AD_object_search
                                    );
use Sophomorix::SophomorixTest qw(
                                 AD_object_nonexist
                                 AD_test_object
                                 run_command
                                 AD_test_session_count
                                 );

$Conf::log_level=1;
my $add=0;
my $mod=0;
my $ses=0;
my $update=0;
my $move=0;
my $kill=0;
my $cp_add=0;
my $cp_update=0;
my $cp_move=0;
my $cp_kill=0;
my $test_add=0;
my $test_update=0;
my $test_move=0;
my $test_kill=0;
my $full=0;
my $help=0;
my $skip_warning=0;
my $verbose_options="";

my $testopt=GetOptions(
           "help|h" => \$help,
           "verbose|v+" => \$Conf::log_level,
           "cp-add" => \$cp_add,
           "cp-update" => \$cp_update,
           "cp-move" => \$cp_move,
           "cp-kill" => \$cp_kill,
           "test-add" => \$test_add,
           "test-update" => \$test_update,
           "test-move" => \$test_move,
           "test-kill" => \$test_kill,
           "add|a" => \$add,
           "mod" => \$mod,
           "ses" => \$ses,
           "update|u" => \$update,
           "move|m" => \$move,
           "kill|k" => \$kill,
           "full|f" => \$full,
           "skip|s" => \$skip_warning,
          );


# Prüfen, ob Optionen erkannt wurden, sonst Abbruch
&check_options($testopt);


if ($Conf::log_level==1){
    $verbose_options="";
} elsif ($Conf::log_level==2){
    $verbose_options="-v";
} elsif ($Conf::log_level==3){
    $verbose_options="-vv";
}


my ($ldap,$root_dse) = &AD_bind_admin();
my $root_dns=&AD_dns_get($root_dse);

my $file_add=$DevelConf::path_result."/sophomorix.add";
my $file_update=$DevelConf::path_result."/sophomorix.update";
my $file_move=$DevelConf::path_result."/sophomorix.move";
my $file_kill=$DevelConf::path_result."/sophomorix.kill";

my $testdata="/usr/share/sophomorix-developer/testdata";
my $file_add_test=$testdata."/sophomorix.add-1";
my $file_update_test=$testdata."/sophomorix.update-1";
my $file_move_test=$testdata."/sophomorix.move-1";
my $file_kill_test=$testdata."/sophomorix.kill-1";

my $file_students=$testdata."/students.csv-1";
my $file_teachers=$testdata."/teachers.csv-1";
my $file_students_bsz=$testdata."/bsz.students.csv-1";
my $file_teachers_bsz=$testdata."/bsz.teachers.csv-1";
my $file_students_uni=$testdata."/uni.students.csv-1";
my $file_teachers_uni=$testdata."/uni.teachers.csv-1";

my $file_school=$testdata."/school.conf-1";
my $file_school_bsz=$testdata."/bsz.school.conf-1";
my $file_school_uni=$testdata."/uni.school.conf-1";

# --help
if ($help==1) {
   # Scriptname ermitteln
   my @list = split(/\//,$0);
   my $scriptname = pop @list;
   # Befehlsbeschreibung
   print('
sophomorix-test-1 tests sophomorix-add,sophomorix-move and sophomorix-kill.

Created users or groups might clash with users or groups already added.
It is recommended that sophomorix-test-1  is only run on test servers without 
existing users and groups.

  - Failed tests will show when not running on an empty system.
  - Created OU\'s will not be deleted at the end of test. 


Options
  -h  / --help

Full automated test:

  -f, --full 
   full test (copying file|add,move,kill|test)
   includes skip
  -s, --skip 
   force overwriting sophomorix.add,sophomorix.move, sophomorix.kill

Step by step Test:

  Copy sophomorix.add:
      sophomorix-test-1 --cp-add
  Add the users:
      sophomorix-add -i
      sophomorix-add
  Test added users:
      sophomorix-test-1 --test-add

  Modify the users
      sophomorix-test-1 --mod

  Test the use of sessions
      sophomorix-test-1 --ses

  Copy sophomorix.update:
      sophomorix-test-1 --cp-update
  Update the users:
      sophomorix-update -i
      sophomorix-update
  Test updated users:
      sophomorix-test-1 --test-update

  Copy sophomorix.move:
      sophomorix-test-1 --cp-move
  Move the users:
      sophomorix-move -i
      sophomorix-move
  Test moved users:
      sophomorix-test-1 --test-move

  Copy sophomorix.kill:
      sophomorix-test-1 --cp-kill
  Kill the users:
      sophomorix-kill -i
      sophomorix-kill
  Test killed users:
      sophomorix-test-1 --test-kill

  --u user / --users user
  --c class / --class class
  --lock / --unlock
');
   print "\n";
   exit;
}




############################################################
# Check preliminaries
############################################################

&run_command("mkdir -p $DevelConf::path_result");


# --full
if ($full==1){
    $add=1;
    $mod=1;
    $ses=1;
    $update=1;
    $move=1;
    $kill=1;
    $skip_warning=1;
}

# --add
if ($add==1){
    if (-e $file_add){
        print "\nTo run this test $file_add must not be there!\n\n";
        if ($skip_warning==0){
            exit;
        }
    }
    my @users=("maiersa42",
               "muellegr42",
               "jonsonad42",
               "samardze42",
               "oe42",
               "wu42",
               "lordjo42",
               "blackmri4",
               "kep42",
               "gal42");
    foreach my $user (@users){
        my ($count,$dn_exist,$cn_exist)=&AD_object_search($ldap,$root_dse,"user",$user);
        if ($count > 0){
            print "\nTo run this test $user must not exist in AD!\n\n";
                exit;
        }
    }
}


# --kill
#if ($kill==1){
#    if (-e $file_kill){
#        print "\nTo run this test $file_kill must not be there!\n\n";
#        if ($skip_warning==0){
#            exit;
#        }
#    }
#}
#print "OHA";
############################################################
# Run the tests
############################################################

############################################################
# Adding users --add
############################################################
if ($cp_add==1){
    # copy sophomorix.add
    &run_command("cp -v $file_add_test $file_add");
    &run_command("cp -v $file_students /etc/linuxmuster/sophomorix/default-school/students.csv");
    &run_command("cp -v $file_teachers /etc/linuxmuster/sophomorix/default-school/teachers.csv");
    &run_command("cp -v $file_students_bsz /etc/linuxmuster/sophomorix/bsz/bsz.students.csv");
    &run_command("cp -v $file_teachers_bsz /etc/linuxmuster/sophomorix/bsz/bsz.teachers.csv");
    &run_command("cp -v $file_students_uni /etc/linuxmuster/sophomorix/uni/uni.students.csv");
    &run_command("cp -v $file_teachers_uni /etc/linuxmuster/sophomorix/uni/uni.teachers.csv");
    &run_command("cp -v $file_school /etc/linuxmuster/sophomorix/default-school/school.conf");
    &run_command("cp -v $file_school_bsz /etc/linuxmuster/sophomorix/bsz/bsz.school.conf");
    &run_command("cp -v $file_school_uni /etc/linuxmuster/sophomorix/uni/uni.school.conf");
}

if ($add==1 or $test_add==1){
    if ($add==1){
        # copy sophomorix.add
        &run_command("cp -v $file_add_test $file_add");
        &run_command("sophomorix-add -i");
        &run_command("sophomorix-add $verbose_options");
    }

    ##### Testing the users

    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m7ab,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m7ab",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"bsz-m7ab",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMembers=>"maiersa42|muellegr42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                   member => "maiersa42|muellegr42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "global-students",
                   member => "bsz-m7ab|bsz-m8cd",
                  });


    # muellegr42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=muellegr42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Gregor Müller",
                   givenName=>"Gregor",
                   name=>"muellegr42",
                   sAMAccountname=>"muellegr42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\muellegr42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/muellegr42",
                   sn=>"Müller",
                   userPrincipalName => "muellegr42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster23!",
                   sophomorixFirstnameASCII => "Gregor",
                   sophomorixSurnameASCII  => "Mueller",
                   sophomorixBirthdate  => "26.01.1992",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid2345",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m7ab,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m7ab",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"bsz-m7ab",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"maiersa42|muellegr42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                   member => "maiersa42|muellegr42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "global-students",
                  });


    # jonsonad42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=jonsonad42,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Aðalráður Jónsson",
                   givenName=>"Aðalráður",
                   name=>"jonsonad42",
                   sAMAccountname=>"jonsonad42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m8cd\\homes\\jonsonad42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m8cd/homes/jonsonad42",
                   sn=>"Jónsson",
                   userPrincipalName => "jonsonad42@".$root_dns,
                   sophomorixAdminClass => "bsz-m8cd",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster23!",
                   sophomorixFirstnameASCII => "Adalradur",
                   sophomorixSurnameASCII  => "Jonsson",
                   sophomorixBirthdate  => "22.03.1996",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid3456",
                   userAccountControl => "512",
                   memberOf => "bsz-m8cd",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m8cd,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m8cd",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"bsz-m8cd",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"jonsonad42|samardze42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                   member => "jonsonad42|samardze42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "global-students",
                  });


    # samardze42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=samardze42,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Željko Samardžić",
                   givenName=>"Željko",
                   name=>"samardze42",
                   sAMAccountname=>"samardze42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m8cd\\homes\\samardze42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m8cd/homes/samardze42",
                   sn=>"Samardžić",
                   userPrincipalName => "samardze42@".$root_dns,
                   sophomorixAdminClass => "bsz-m8cd",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Zeljko",
                   sophomorixSurnameASCII  => "Samardzic",
                   sophomorixBirthdate  => "22.04.1992",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid4567",
                   userAccountControl => "512",
                   memberOf => "bsz-m8cd",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m8cd,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m8cd",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"bsz-m8cd",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"jonsonad42|samardze42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                   member => "jonsonad42|samardze42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "global-students",
                  });


    # oe42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=oe42,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Gökhan Ömür",
                   givenName=>"Gökhan",
                   name=>"oe42",
                   sAMAccountname=>"oe42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\teachers\\homes\\oe42",
                   unixHomeDirectory=>"/home/schools/bsz/teachers/homes/oe42",
                   sn=>"Ömür",
                   userPrincipalName => "oe42@".$root_dns,
                   sophomorixAdminClass => "bsz-teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster23!",
                   sophomorixFirstnameASCII => "Goekhan",
                   sophomorixSurnameASCII  => "Oemuer",
                   sophomorixBirthdate  => "15.09.1976",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid5678",
                   userAccountControl => "512",
                   memberOf => "bsz-teachers",
                  });

    # wu42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=wu42,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Désirée Würth",
                   givenName=>"Désirée",
                   name=>"wu42",
                   sAMAccountname=>"wu42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\teachers\\homes\\wu42",
                   unixHomeDirectory=>"/home/schools/bsz/teachers/homes/wu42",
                   sn=>"Würth",
                   userPrincipalName => "wu42@".$root_dns,
                   sophomorixAdminClass => "bsz-teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster!",
                   sophomorixFirstnameASCII => "Desiree",
                   sophomorixSurnameASCII  => "Wuerth",
                   sophomorixBirthdate  => "23.12.1972",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   memberOf => "bsz-teachers",
                  });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-teachers,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   sophomorixMembers=>"oe42|wu42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "global-teachers",
                   member => "oe42|wu42",
                  });


    # blackmri42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=blackmri42,OU=12abc,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Richard Blackmore",
                   givenName=>"Richard",
                   name=>"blackmri42",
                   sAMAccountname=>"blackmri42",
                   uidNumber=>"90000",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\uni\\students\\12abc\\homes\\blackmri42",
                   unixHomeDirectory=>"/home/schools/uni/students/12abc/homes/blackmri42",
                   sn=>"Blackmore",
                   userPrincipalName => "blackmri42@".$root_dns,
                   sophomorixAdminClass => "uni-12abc",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Richard",
                   sophomorixSurnameASCII  => "Blackmore",
                   sophomorixBirthdate  => "16.01.1995",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unidb1234",
                   userAccountControl => "512",
                   memberOf => "uni-12abc",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-12abc,OU=12abc,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-12abc",
                   gidNumber=>"90001",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"uni-12abc",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"lordjo42|blackmri42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "uni",
                   memberOf => "uni-students",
                   member => "lordjo42|blackmri42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-students,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "uni",
                   memberOf => "global-students",
                  });


    # lordjo42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=lordjo42,OU=12abc,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Jon Lord",
                   givenName=>"Jon",
                   name=>"lordjo42",
                   sAMAccountname=>"lordjo42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\uni\\students\\12abc\\homes\\lordjo42",
                   unixHomeDirectory=>"/home/schools/uni/students/12abc/homes/lordjo42",
                   sn=>"Lord",
                   userPrincipalName => "lordjo42@".$root_dns,
                   sophomorixAdminClass => "uni-12abc",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster23!",
                   sophomorixFirstnameASCII => "Jon",
                   sophomorixSurnameASCII  => "Lord",
                   sophomorixBirthdate  => "22.01.1994",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unidb2345",
                   userAccountControl => "512",
                   memberOf => "uni-12abc",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-12abc,OU=12abc,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-12abc",
                   gidNumber=>"90001",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"uni-12abc",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"lordjo42|blackmri42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "uni",
                   memberOf => "uni-students",
                   member => "lordjo42|blackmri42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-students,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "uni",
                   memberOf => "global-students",
                  });


    # kep42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=kep42,OU=Teachers,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Johannes Kepler",
                   givenName=>"Johannes",
                   name=>"kep42",
                   sAMAccountname=>"kep42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\uni\\teachers\\homes\\kep42",
                   unixHomeDirectory=>"/home/schools/uni/teachers/homes/kep42",
                   sn=>"Kepler",
                   userPrincipalName => "kep42@".$root_dns,
                   sophomorixAdminClass => "uni-teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster23!",
                   sophomorixFirstnameASCII => "Johannes",
                   sophomorixSurnameASCII  => "Kepler",
                   sophomorixBirthdate  => "15.08.1976",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "---",
                   userAccountControl => "512",
                   memberOf => "uni-teachers",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-teachers,OU=Teachers,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   sophomorixMembers=>"kep42|gal42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "uni",
                   memberOf => "global-teachers",
                   member => "kep42|gal42",
              });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-teachers,OU=Teachers,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   sophomorixMembers=>"kep42|gal42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "uni",
                   memberOf => "global-teachers",
                   member => "kep42|gal42",
                  });


    # gal42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=gal42,OU=Teachers,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Galileo Galilei",
                   givenName=>"Galileo",
                   name=>"gal42",
                   sAMAccountname=>"gal42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\uni\\teachers\\homes\\gal42",
                   unixHomeDirectory=>"/home/schools/uni/teachers/homes/gal42",
                   sn=>"Galilei",
                   userPrincipalName => "gal42@".$root_dns,
                   sophomorixAdminClass => "uni-teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster!",
                   sophomorixFirstnameASCII => "Galileo",
                   sophomorixSurnameASCII  => "Galilei",
                   sophomorixBirthdate  => "23.10.1972",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unidb6789",
                   userAccountControl => "512",
                   memberOf => "uni-teachers",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-teachers,OU=Teachers,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   sophomorixMembers=>"kep42|gal42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "uni",
                   memberOf => "global-teachers",
                   member => "kep42|gal42",
              });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-teachers,OU=Teachers,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   sophomorixMembers=>"kep42|gal42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "uni",
                   memberOf => "global-teachers",
                   member => "kep42|gal42",
                  });


    # schneima42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=schneima42,OU=s6ade,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Marina Schneider",
                   givenName=>"Marina",
                   name=>"schneima42",
                   sAMAccountname=>"schneima42",
                   uidNumber=>"99000",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\default-school\\students\\s6ade\\homes\\schneima42",
                   unixHomeDirectory=>"/home/schools/default-school/students/s6ade/homes/schneima42",
                   sn=>"Schneider",
                   userPrincipalName => "schneima42@".$root_dns,
                   sophomorixAdminClass => "s6ade",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Marina",
                   sophomorixSurnameASCII  => "Schneider",
                   sophomorixBirthdate  => "21.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "---",
                   sophomorixSchoolname => "default-school",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid12345",
                   userAccountControl => "512",
                   memberOf => "s6ade",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=s6ade,OU=s6ade,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"s6ade",
                   gidNumber=>"99001",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"s6ade",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"schneima42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "default-school",
                   memberOf => "students",
                   member => "schneima42",
                  });
    ##### Testing the users ou-students group    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=students,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "default-school",
                   memberOf => "global-students",
                  });
    # sch42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=sch42,OU=Teachers,OU=default-school,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Michael Schäfer",
                   givenName=>"Michael",
                   name=>"sch42",
                   sAMAccountname=>"sch42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\default-school\\teachers\\homes\\sch42",
                   unixHomeDirectory=>"/home/schools/default-school/teachers/homes/sch42",
                   sn=>"Schäfer",
                   userPrincipalName => "sch42@".$root_dns,
                   sophomorixAdminClass => "teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster!",
                   sophomorixFirstnameASCII => "Michael",
                   sophomorixSurnameASCII  => "Schaefer",
                   sophomorixBirthdate  => "12.05.1991",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "---",
                   sophomorixSchoolname => "default-school",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid123456",
                   userAccountControl => "512",
                   memberOf => "teachers",
                  });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=teachers,OU=Teachers,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"teachers",
                   gidNumber=>"-1",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "default-school",
                   memberOf => "global-teachers",
                   member => "sch42",
                  });

    ##### Testing the global groups
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=global-wifi,OU=Management,OU=GLOBAL,".$root_dse,
                   sAMAccountname=>"global-wifi",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"globalwifiaccess",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "global",
                   memberOf => "",
                   member => "bsz-wifi|uni-wifi|wifi",
                  });
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=global-internet,OU=Management,OU=GLOBAL,".$root_dse,
                   sAMAccountname=>"global-internet",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"globalinternetaccess",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "global",
                   memberOf => "",
                   member => "bsz-internet|uni-internet|internet",
                  });
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=global-admins,OU=Management,OU=GLOBAL,".$root_dse,
                   sAMAccountname=>"global-admins",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"globaladmins",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "global",
                   memberOf => "",
                   member => "bsz-admins|uni-admins|admins",
                  });
    # &AD_test_object({ldap=>$ldap,
    #                dn=>"CN=global-examaccounts,OU=ExamAccounts,OU=GLOBAL,".$root_dse,
    #                sAMAccountname=>"global-examaccounts",
    #                gidNumber=>"-1",
    #                sophomorixCreationDate => "exists",
    #                sophomorixStatus=>"P",
    #                sophomorixType=>"globalmanagementgroup",
    #                sophomorixHidden=>"FALSE",
    #                sophomorixSchoolname => "global",
    #                memberOf => "",
    #                member => "bsz-examaccounts,uni-examaccounts,examaccounts,",
    #               });
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=global-students,OU=Groups,OU=GLOBAL,".$root_dse,
                   sAMAccountname=>"global-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"globalclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "global",
                   memberOf => "",
                   member => "bsz-students|uni-students|students",
                  });
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=global-teachers,OU=Groups,OU=GLOBAL,".$root_dse,
                   sAMAccountname=>"global-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"globalclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "global",
                   memberOf => "",
                   member => "bsz-teachers|uni-teachers|teachers",
                  });
}



############################################################
# Modifying users --mod
############################################################
if ($mod==1){

    &run_command("sophomorix-user $verbose_options -F --user maiersa42");
    # Testing change
    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "F",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });

    &run_command("sophomorix-user $verbose_options -P --user maiersa42");
    # Testing change
    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixStatus => "P",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });

    &run_command("sophomorix-user $verbose_options -R --user maiersa42");
    # Testing change
    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "R",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });

    &run_command("sophomorix-user $verbose_options -K --user maiersa42");
    # Testing change
    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "K",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });

    &run_command("sophomorix-user $verbose_options -A --user maiersa42");
    # Testing change
    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "A",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });

    &run_command("sophomorix-user $verbose_options --comment \"Test Comment!\" --user maiersa42");
    # Testing change
    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "Test Comment!",
                   sophomorixStatus => "A",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });

    &run_command("sophomorix-user $verbose_options --webui-dashboard \"Test webui!\" --user maiersa42");
    # Testing change
    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "Test Comment!",
                   sophomorixWebuiDashboard => "Test webui!",
                   sophomorixStatus => "A",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });

    &run_command("sophomorix-user $verbose_options --user-permissions one,two,three --user maiersa42");
    # Testing change
    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "Test Comment!",
                   sophomorixWebuiDashboard => "Test webui!",
                   sophomorixUserPermissions => "one|two|three",
                   sophomorixStatus => "A",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });
    &run_command("sophomorix-user $verbose_options --add-user-permissions four,five --user maiersa42");
    # Testing change
    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "Test Comment!",
                   sophomorixWebuiDashboard => "Test webui!",
                   sophomorixUserPermissions => "one|two|three|four|five",
                   sophomorixStatus => "A",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });

    &run_command("sophomorix-user $verbose_options --remove-user-permissions one,two --user maiersa42");
    # Testing change
    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "Test Comment!",
                   sophomorixWebuiDashboard => "Test webui!",
                   sophomorixUserPermissions => "three|four|five",
                   sophomorixStatus => "A",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });






    &run_command("sophomorix-user $verbose_options -U --user maiersa42 --remove-user-permissions three,four,five --webui-dashboard \"\" --comment \"created by sophomorix\"");
    # Testing if maiersa42 is feft as before
    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });
}


############################################################
# Managing sessions --ses
############################################################
if ($ses==1){
    print "Session tests\n";
    &run_command("sophomorix-session $verbose_options --create --teacher maiersa42 --developer-session 666");
    &run_command("sophomorix-session $verbose_options --create --teacher maiersa42 --developer-session 777");
    print "HERE1\n";
    &AD_test_session_count($ldap,$root_dse,$root_dns,2);
    print "HERE2\n";
    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                   sophomorixSessions => "666;|777;",
                  });

    &run_command("sophomorix-session $verbose_options --session 666 --members lordjo42");
    &run_command("sophomorix-session $verbose_options --session 777 --members lordjo42,blackmri42");
    &AD_test_session_count($ldap,$root_dse,$root_dns,2);

    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",            
                   sophomorixSessions => "666;lordjo42|777;lordjo42,blackmri42",
                  });

    # --removemembers
    &run_command("sophomorix-session $verbose_options --session 777 --removemembers blackmri42");
    &AD_test_session_count($ldap,$root_dse,$root_dns,2);

    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",            
                   sophomorixSessions => "666;lordjo42|777;lordjo42",
                  });

    # --removemembers (removing nonexisting member)
    &run_command("sophomorix-session $verbose_options --session 777 --removemembers blackmri42");
    &AD_test_session_count($ldap,$root_dse,$root_dns,2);

    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",            
                   sophomorixSessions => "666;lordjo42|777;lordjo42",
                  });


    # --addmembers (adding already existing member)
    &run_command("sophomorix-session $verbose_options --session 777 --addmembers lordjo42");
    &AD_test_session_count($ldap,$root_dse,$root_dns,2);

    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",            
                   sophomorixSessions => "666;lordjo42|777;lordjo42",
                  });


    # --addmembers
    &run_command("sophomorix-session $verbose_options --session 666 --addmembers blackmri42");
    &AD_test_session_count($ldap,$root_dse,$root_dns,2);

    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Maier",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",            
                   sophomorixSessions => "666;lordjo42,blackmri42|777;lordjo42",
                  });

    # --set-exam-mode
    &run_command("sophomorix-session $verbose_options --session 666 --set-exam-mode lordjo42,blackmri42");

    # lordjo42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=lordjo42,OU=12abc,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Jon Lord",
                   givenName=>"Jon",
                   name=>"lordjo42",
                   sAMAccountname=>"lordjo42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\uni\\students\\12abc\\homes\\lordjo42",
                   unixHomeDirectory=>"/home/schools/uni/students/12abc/homes/lordjo42",
                   sn=>"Lord",
                   userPrincipalName => "lordjo42@".$root_dns,
                   sophomorixAdminClass => "uni-12abc",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster23!",
                   sophomorixFirstnameASCII => "Jon",
                   sophomorixSurnameASCII  => "Lord",
                   sophomorixBirthdate  => "22.01.1994",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "maiersa42",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unidb2345",
                   userAccountControl => "512",
                   memberOf => "uni-12abc",
                  });

    # blackmri42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=blackmri42,OU=12abc,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Richard Blackmore",
                   givenName=>"Richard",
                   name=>"blackmri42",
                   sAMAccountname=>"blackmri42",
                   uidNumber=>"90000",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\uni\\students\\12abc\\homes\\blackmri42",
                   unixHomeDirectory=>"/home/schools/uni/students/12abc/homes/blackmri42",
                   sn=>"Blackmore",
                   userPrincipalName => "blackmri42@".$root_dns,
                   sophomorixAdminClass => "uni-12abc",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Richard",
                   sophomorixSurnameASCII  => "Blackmore",
                   sophomorixBirthdate  => "16.01.1995",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "maiersa42",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unidb1234",
                   userAccountControl => "512",
                   memberOf => "uni-12abc",
                  });


    # --unset-exam-mode
    &run_command("sophomorix-session $verbose_options --session 666 --unset-exam-mode lordjo42,blackmri42");

    # lordjo42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=lordjo42,OU=12abc,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Jon Lord",
                   givenName=>"Jon",
                   name=>"lordjo42",
                   sAMAccountname=>"lordjo42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\uni\\students\\12abc\\homes\\lordjo42",
                   unixHomeDirectory=>"/home/schools/uni/students/12abc/homes/lordjo42",
                   sn=>"Lord",
                   userPrincipalName => "lordjo42@".$root_dns,
                   sophomorixAdminClass => "uni-12abc",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster23!",
                   sophomorixFirstnameASCII => "Jon",
                   sophomorixSurnameASCII  => "Lord",
                   sophomorixBirthdate  => "22.01.1994",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unidb2345",
                   userAccountControl => "512",
                   memberOf => "uni-12abc",
                  });

    # blackmri42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=blackmri42,OU=12abc,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Richard Blackmore",
                   givenName=>"Richard",
                   name=>"blackmri42",
                   sAMAccountname=>"blackmri42",
                   uidNumber=>"90000",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\uni\\students\\12abc\\homes\\blackmri42",
                   unixHomeDirectory=>"/home/schools/uni/students/12abc/homes/blackmri42",
                   sn=>"Blackmore",
                   userPrincipalName => "blackmri42@".$root_dns,
                   sophomorixAdminClass => "uni-12abc",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Richard",
                   sophomorixSurnameASCII  => "Blackmore",
                   sophomorixBirthdate  => "16.01.1995",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unidb1234",
                   userAccountControl => "512",
                   memberOf => "uni-12abc",
                  });



    &run_command("sophomorix-session $verbose_options --kill --session 666");
    &run_command("sophomorix-session $verbose_options --kill --session 777");

    &AD_test_session_count($ldap,$root_dse,$root_dns,0);
}


############################################################
# Moving users --move
############################################################
if ($cp_update==1){
    # copy sophomorix.update
    &run_command("cp -v $file_update_test $file_update");
}

if ($update==1 or $test_update==1){
    if ($update==1){
        # copy sophomorix.update
        &run_command("cp -v $file_update_test $file_update");
        &run_command("sophomorix-update -i");
        &run_command("sophomorix-update $verbose_options");
    }

    ##### Testing the users
    # maiersa42 ->  surname
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Mayer",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/maiersa42",
                   sn=>"Mayer",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Mayer",
                   sophomorixBirthdate => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });

    # muellegr42 -> birthday
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=muellegr42,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Gregor Müller",
                   givenName=>"Gregor",
                   name=>"muellegr42",
                   sAMAccountname=>"muellegr42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\homes\\muellegr42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m7ab/homes/muellegr42",
                   sn=>"Müller",
                   userPrincipalName => "muellegr42@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster23!",
                   sophomorixFirstnameASCII => "Gregor",
                   sophomorixSurnameASCII  => "Mueller",
                   sophomorixBirthdate  => "12.12.1989",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid2345",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab",
                  });

    # samardze42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=samardze42,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Schellko Samardžić",
                   givenName=>"Schellko",
                   name=>"samardze42",
                   sAMAccountname=>"samardze42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m8cd\\homes\\samardze42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m8cd/homes/samardze42",
                   sn=>"Samardžić",
                   userPrincipalName => "samardze42@".$root_dns,
                   sophomorixAdminClass => "bsz-m8cd",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Schellko",
                   sophomorixSurnameASCII  => "Samardzic",
                   sophomorixBirthdate  => "22.04.1992",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid4567",
                   userAccountControl => "512",
                   memberOf => "bsz-m8cd",
                  });

}


############################################################
# Moving users --move
############################################################
if ($cp_move==1){
    # copy sophomorix.move
    &run_command("cp -v $file_move_test $file_move");
}

if ($move==1 or $test_move==1){
    if ($move==1){
        # copy sophomorix.move
        &run_command("cp -v $file_move_test $file_move");
        &run_command("sophomorix-move -i");
        &run_command("sophomorix-move $verbose_options");
    }

    ##### Testing the users

    # maiersa42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa42,OU=attic,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Mayer",
                   givenName=>"Sarina",
                   name=>"maiersa42",
                   sAMAccountname=>"maiersa42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\attic\\homes\\maiersa42",
                   unixHomeDirectory=>"/home/schools/bsz/students/attic/homes/maiersa42",
                   sn=>"Mayer",
                   userPrincipalName => "maiersa42@".$root_dns,
                   sophomorixAdminClass => "bsz-attic",
                   sophomorixExitAdminClass => "bsz-m7ab",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Mayer",
                   sophomorixBirthdate  => "25.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-attic",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-attic,OU=attic,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-attic",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"bsz-attic",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"maiersa42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                   member => "maiersa42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "global-students",
                  });


    # muellegr42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=muellegr42,OU=attic,OU=Students,OU=lin,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Gregor Müller",
                   givenName=>"Gregor",
                   name=>"muellegr42",
                   sAMAccountname=>"muellegr42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\lin\\students\\attic\\homes\\muellegr42",
                   unixHomeDirectory=>"/home/schools/lin/students/attic/homes/muellegr42",
                   sn=>"Müller",
                   userPrincipalName => "muellegr42@".$root_dns,
                   sophomorixAdminClass => "lin-attic",
                   sophomorixExitAdminClass => "bsz-m7ab",
                   sophomorixFirstPassword => "Muster23!",
                   sophomorixFirstnameASCII => "Gregor",
                   sophomorixSurnameASCII  => "Mueller",
                   sophomorixBirthdate  => "12.12.1989",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "lin",
                   sophomorixSchoolname => "lin",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid2345",
                   userAccountControl => "512",
                   memberOf => "lin-attic",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=lin-attic,OU=attic,OU=Students,OU=lin,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"lin-attic",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"lin-attic",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"muellegr42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "lin",
                   memberOf => "lin-students",
                   member => "muellegr42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=lin-students,OU=Students,OU=lin,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"lin-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "lin",
                   memberOf => "global-students",
                  });


    # jonsonad42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=jonsonad42,OU=m9cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Aðalráður Jónsson",
                   givenName=>"Aðalráður",
                   name=>"jonsonad42",
                   sAMAccountname=>"jonsonad42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m9cd\\homes\\jonsonad42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m9cd/homes/jonsonad42",
                   sn=>"Jónsson",
                   userPrincipalName => "jonsonad42@".$root_dns,
                   sophomorixAdminClass => "bsz-m9cd",
                   sophomorixExitAdminClass => "bsz-m8cd",
                   sophomorixFirstPassword => "Muster23!",
                   sophomorixFirstnameASCII => "Adalradur",
                   sophomorixSurnameASCII  => "Jonsson",
                   sophomorixBirthdate  => "22.03.1996",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid3456",
                   userAccountControl => "512",
                   memberOf => "bsz-m9cd",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m9cd,OU=m9cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m9cd",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"bsz-m9cd",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"jonsonad42|samardze42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                   member => "jonsonad42|samardze42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "global-students",
                  });


    # samardze42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=samardze42,OU=m9cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Schellko Samardžić",
                   givenName=>"Schellko",
                   name=>"samardze42",
                   sAMAccountname=>"samardze42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m9cd\\homes\\samardze42",
                   unixHomeDirectory=>"/home/schools/bsz/students/m9cd/homes/samardze42",
                   sn=>"Samardžić",
                   userPrincipalName => "samardze42@".$root_dns,
                   sophomorixAdminClass => "bsz-m9cd",
                   sophomorixExitAdminClass => "bsz-m8cd",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Schellko",
                   sophomorixSurnameASCII  => "Samardzic",
                   sophomorixBirthdate  => "22.04.1992",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid4567",
                   userAccountControl => "512",
                   memberOf => "bsz-m9cd",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m9cd,OU=m9cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m9cd",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"bsz-m9cd",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"jonsonad42|samardze42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                   member => "jonsonad42|samardze42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "global-students",
                  });


    # oe42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=oe42,OU=alumni,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Gökhan Ömür",
                   givenName=>"Gökhan",
                   name=>"oe42",
                   sAMAccountname=>"oe42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\alumni\\homes\\oe42",
                   unixHomeDirectory=>"/home/schools/bsz/students/alumni/homes/oe42",
                   sn=>"Ömür",
                   userPrincipalName => "oe42@".$root_dns,
                   sophomorixAdminClass => "bsz-alumni",
                   sophomorixExitAdminClass => "bsz-teachers",
                   sophomorixFirstPassword => "LinuxMuster23!",
                   sophomorixFirstnameASCII => "Goekhan",
                   sophomorixSurnameASCII  => "Oemuer",
                   sophomorixBirthdate  => "15.09.1976",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid5678",
                   userAccountControl => "512",
                   memberOf => "bsz-alumni",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-alumni,OU=alumni,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-alumni",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"bsz-alumni",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"oe42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                   member => "oe42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "global-students",
                  });


    # wu42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=wu42,OU=Teachers,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Désirée Würth",
                   givenName=>"Désirée",
                   name=>"wu42",
                   sAMAccountname=>"wu42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\uni\\teachers\\homes\\wu42",
                   unixHomeDirectory=>"/home/schools/uni/teachers/homes/wu42",
                   sn=>"Würth",
                   userPrincipalName => "wu42@".$root_dns,
                   sophomorixAdminClass => "uni-teachers",
                   sophomorixExitAdminClass => "bsz-teachers",
                   sophomorixFirstPassword => "LinuxMuster!",
                   sophomorixFirstnameASCII => "Desiree",
                   sophomorixSurnameASCII  => "Wuerth",
                   sophomorixBirthdate  => "23.12.1972",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid6789",
                   userAccountControl => "512",
                   memberOf => "uni-teachers",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-teachers,OU=Teachers,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   sophomorixMembers=>"wu42|lordjo42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "uni",
                   memberOf => "global-teachers",
                   member => "wu42|lordjo42",
              });


    # lordjo42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=lordjo42,OU=Teachers,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Jon Lord",
                   givenName=>"Jon",
                   name=>"lordjo42",
                   sAMAccountname=>"lordjo42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\uni\\teachers\\homes\\lordjo42",
                   unixHomeDirectory=>"/home/schools/uni/teachers/homes/lordjo42",
                   sn=>"Lord",
                   userPrincipalName => "lordjo42@".$root_dns,
                   sophomorixAdminClass => "uni-teachers",
                   sophomorixExitAdminClass => "uni-12abc",
                   sophomorixFirstPassword => "Muster23!",
                   sophomorixFirstnameASCII => "Jon",
                   sophomorixSurnameASCII  => "Lord",
                   sophomorixBirthdate  => "22.01.1994",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unidb2345",
                   userAccountControl => "512",
                   memberOf => "uni-teachers",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-teachers,OU=Teachers,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   sophomorixMembers=>"wu42|lordjo42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "uni",
                   memberOf => "global-teachers",
                   member => "wu42|lordjo42",
                  });


    # blackmri42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=blackmri42,OU=Teachers,OU=lin,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Richard Blackmore",
                   givenName=>"Richard",
                   name=>"blackmri42",
                   sAMAccountname=>"blackmri42",
                   uidNumber=>"90000",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\lin\\teachers\\homes\\blackmri42",
                   unixHomeDirectory=>"/home/schools/lin/teachers/homes/blackmri42",
                   sn=>"Blackmore",
                   userPrincipalName => "blackmri42@".$root_dns,
                   sophomorixAdminClass => "lin-teachers",
                   sophomorixExitAdminClass => "uni-12abc",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Richard",
                   sophomorixSurnameASCII  => "Blackmore",
                   sophomorixBirthdate  => "16.01.1995",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "lin",
                   sophomorixSchoolname => "lin",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unidb1234",
                   userAccountControl => "512",
                   memberOf => "lin-teachers",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=lin-teachers,OU=Teachers,OU=lin,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"lin-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   sophomorixMembers=>"blackmri42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "lin",
                   memberOf => "global-teachers",
                   member => "blackmri42",
                });


    # kep42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=kep42,OU=alumni,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Johannes Kepler",
                   givenName=>"Johannes",
                   name=>"kep42",
                   sAMAccountname=>"kep42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\uni\\students\\alumni\\homes\\kep42",
                   unixHomeDirectory=>"/home/schools/uni/students/alumni/homes/kep42",
                   sn=>"Kepler",
                   userPrincipalName => "kep42@".$root_dns,
                   sophomorixAdminClass => "uni-alumni",
                   sophomorixExitAdminClass => "uni-teachers",
                   sophomorixFirstPassword => "LinuxMuster23!",
                   sophomorixFirstnameASCII => "Johannes",
                   sophomorixSurnameASCII  => "Kepler",
                   sophomorixBirthdate  => "15.08.1976",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "uni",
                   sophomorixSchoolname => "uni",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "---",
                   userAccountControl => "512",
                   memberOf => "uni-alumni",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-alumni,OU=alumni,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-alumni",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"uni-alumni",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"kep42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "uni",
                   memberOf => "uni-students",
                   member => "kep42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=uni-students,OU=Students,OU=uni,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"uni-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "uni",
                   memberOf => "global-students",
                  });

    # gal42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=gal42,OU=alumni,OU=Students,OU=ghs,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Galileo Galilei",
                   givenName=>"Galileo",
                   name=>"gal42",
                   sAMAccountname=>"gal42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\ghs\\students\\alumni\\homes\\gal42",
                   unixHomeDirectory=>"/home/schools/ghs/students/alumni/homes/gal42",
                   sn=>"Galilei",
                   userPrincipalName => "gal42@".$root_dns,
                   sophomorixAdminClass => "ghs-alumni",
                   sophomorixExitAdminClass => "uni-teachers",
                   sophomorixFirstPassword => "LinuxMuster!",
                   sophomorixFirstnameASCII => "Galileo",
                   sophomorixSurnameASCII  => "Galilei",
                   sophomorixBirthdate  => "23.10.1972",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "ghs",
                   sophomorixSchoolname => "ghs",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unidb6789",
                   userAccountControl => "512",
                   memberOf => "ghs-alumni",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=ghs-alumni,OU=alumni,OU=Students,OU=ghs,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"ghs-alumni",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"ghs-alumni",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"gal42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "ghs",
                   memberOf => "ghs-students",
                   member => "gal42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=ghs-students,OU=Students,OU=ghs,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"ghs-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "ghs",
                   memberOf => "global-students",
                  });

   # schneima42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=schneima42,OU=s7ade,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Marina Schneider",
                   givenName=>"Marina",
                   name=>"schneima42",
                   sAMAccountname=>"schneima42",
                   uidNumber=>"99000",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\default-school\\students\\s7ade\\homes\\schneima42",
                   unixHomeDirectory=>"/home/schools/default-school/students/s7ade/homes/schneima42",
                   sn=>"Schneider",
                   userPrincipalName => "schneima42@".$root_dns,
                   sophomorixAdminClass => "s7ade",
                   sophomorixExitAdminClass => "s6ade",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Marina",
                   sophomorixSurnameASCII  => "Schneider",
                   sophomorixBirthdate  => "21.01.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "---",
                   sophomorixSchoolname => "default-school",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid12345",
                   userAccountControl => "512",
                   memberOf => "s7ade",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=s7ade,OU=s7ade,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"s7ade",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"s7ade",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"schneima42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "default-school",
                   memberOf => "students",
                   member => "schneima42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=students,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "default-school",
                   memberOf => "global-students",
                  });


    
    # sch42
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=sch42,OU=alumni,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Michael Schäfer",
                   givenName=>"Michael",
                   name=>"sch42",
                   sAMAccountname=>"sch42",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\default-school\\students\\alumni\\homes\\sch42",
                   unixHomeDirectory=>"/home/schools/default-school/students/alumni/homes/sch42",
                   sn=>"Schäfer",
                   userPrincipalName => "sch42@".$root_dns,
                   sophomorixAdminClass => "alumni",
                   sophomorixExitAdminClass => "teachers",
                   sophomorixFirstPassword => "LinuxMuster!",
                   sophomorixFirstnameASCII => "Michael",
                   sophomorixSurnameASCII  => "Schaefer",
                   sophomorixBirthdate  => "12.05.1991",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "---",
                   sophomorixSchoolname => "default-school",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus => "U",
                   sophomorixUnid => "unid123456",
                   userAccountControl => "512",
                   memberOf => "alumni",
                   userAccountControl => "512",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=alumni,OU=alumni,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"alumni",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixType=>"adminclass",
                   description=>"alumni",
                   sophomorixAddQuota=>"---",
                   sophomorixAddMailQuota=>"---",
                   sophomorixQuota=>"---",
                   sophomorixMailQuota=>"-1",
                   sophomorixMailAlias=>"FALSE",
                   sophomorixMailList=>"FALSE",
                   sophomorixStatus=>"P",
                   sophomorixJoinable=>"TRUE",
                   sophomorixMaxMembers=>"0",
                   sophomorixMembers=>"sch42",
                   sophomorixAdmins=>"",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "default-school",
                   memberOf => "students",
                   member => "sch42",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=students,OU=Students,OU=default-school,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "default-school",
                   memberOf => "global-students",
                  });

    ##### Testing the global groups
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=global-wifi,OU=Management,OU=GLOBAL,".$root_dse,
                   sAMAccountname=>"global-wifi",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"globalwifiaccess",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "global",
                   memberOf => "",
                   member => "ghs-wifi|lin-wifi|bsz-wifi|uni-wifi|wifi",
                  });
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=global-internet,OU=Management,OU=GLOBAL,".$root_dse,
                   sAMAccountname=>"global-internet",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"globalinternetaccess",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "global",
                   memberOf => "",
                   member => "ghs-internet|lin-internet|bsz-internet|uni-internet|internet",
                  });
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=global-admins,OU=Management,OU=GLOBAL,".$root_dse,
                   sAMAccountname=>"global-admins",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"globaladmins",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "global",
                   memberOf => "",
                   member => "ghs-admins|lin-admins|bsz-admins|uni-admins|admins",
                  });
    # &AD_test_object({ldap=>$ldap,
    #                dn=>"CN=global-examaccounts,OU=GLOBAL,".$root_dse,
    #                sAMAccountname=>"global-examaccounts",
    #                gidNumber=>"-1",
    #                sophomorixCreationDate => "exists",
    #                sophomorixStatus=>"P",
    #                sophomorixType=>"globalmanagementgroup",
    #                sophomorixHidden=>"FALSE",
    #               sophomorixSchoolname => "global",
    #                memberOf => "",
    #                member => "ghs-examaccounts|lin-examaccounts|bsz-examaccounts|uni-examaccounts|examaccounts|,
    #               });
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=global-students,OU=Groups,OU=GLOBAL,".$root_dse,
                   sAMAccountname=>"global-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"globalclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "global",
                   memberOf => "",
                   member => "bsz-students|uni-students|lin-students|ghs-students|students",
                  });
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=global-teachers,OU=Groups,OU=GLOBAL,".$root_dse,
                   sAMAccountname=>"global-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"globalclass",
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "global",
                   memberOf => "",
                   member => "bsz-teachers|uni-teachers|lin-teachers|ghs-teachers|teachers",
                  });
}




############################################################
# Deleting users --kill
############################################################
if ($cp_kill==1){
    # copy sophomorix.kill
    &run_command("cp -v $file_kill_test $file_kill");
}

if ($kill==1 or $test_kill==1){
    if ($kill==1){
        &run_command("cp -v $file_kill_test $file_kill");
        &run_command("sophomorix-kill -i");
        &run_command("sophomorix-kill $verbose_options");
        # removing adminclasses,teacherclasses
        &run_command("sophomorix-class --kill --class teachers $verbose_options");
        &run_command("sophomorix-class --kill --class m7ab $verbose_options");
        &run_command("sophomorix-class --kill --class m8cd $verbose_options");
        &run_command("sophomorix-class --kill --class uni-12abc $verbose_options");
        &run_command("sophomorix-class --kill --class s6ade $verbose_options");
        &run_command("sophomorix-class --kill --class attic $verbose_options");
        &run_command("sophomorix-class --kill --class lin-attic $verbose_options");
        &run_command("sophomorix-class --kill --class m9cd $verbose_options");
        &run_command("sophomorix-class --kill --class s7ade $verbose_options");
        &run_command("sophomorix-class --kill --class alumni $verbose_options");
        &run_command("sophomorix-class --kill --class ghs-alumni $verbose_options");
        &run_command("sophomorix-class --kill --class uni-teachers $verbose_options");
    }

    ##### Testing the users
    &AD_object_nonexist($ldap,$root_dse,"user","maiersa42");
    &AD_object_nonexist($ldap,$root_dse,"user","muellegr42");
    &AD_object_nonexist($ldap,$root_dse,"user","jonsonad42");
    &AD_object_nonexist($ldap,$root_dse,"user","samardze42");
    &AD_object_nonexist($ldap,$root_dse,"user","oe42");
    &AD_object_nonexist($ldap,$root_dse,"user","wu42");
    &AD_object_nonexist($ldap,$root_dse,"user","lordjo42");
    &AD_object_nonexist($ldap,$root_dse,"user","blackmri42");
    &AD_object_nonexist($ldap,$root_dse,"user","kep42");
    &AD_object_nonexist($ldap,$root_dse,"user","gal42");
    &AD_object_nonexist($ldap,$root_dse,"user","schneima42");
    &AD_object_nonexist($ldap,$root_dse,"user","sch42");

    ##### Testing the groups
    &AD_object_nonexist($ldap,$root_dse,"group","teachers");
    &AD_object_nonexist($ldap,$root_dse,"group","m7ab");
    &AD_object_nonexist($ldap,$root_dse,"group","m8cd");
    &AD_object_nonexist($ldap,$root_dse,"group","12abc");
    &AD_object_nonexist($ldap,$root_dse,"group","uni-12abc");
    &AD_object_nonexist($ldap,$root_dse,"group","s6ade");
    &AD_object_nonexist($ldap,$root_dse,"group","attic");
    &AD_object_nonexist($ldap,$root_dse,"group","lin-attic");
    &AD_object_nonexist($ldap,$root_dse,"group","m9cd");
    &AD_object_nonexist($ldap,$root_dse,"group","m9cd");
    &AD_object_nonexist($ldap,$root_dse,"group","s7ade");
    &AD_object_nonexist($ldap,$root_dse,"group","alumni");
    &AD_object_nonexist($ldap,$root_dse,"group","ghs-alumni");
}



&AD_unbind_admin($ldap);



