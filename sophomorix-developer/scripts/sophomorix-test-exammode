#!/usr/bin/perl -w
# This script (sophomorix-test-exammode) is maintained by Rüdiger Beck
# It is Free Software (License GPLv3)
# If you find errors, contact the author
# jeffbeck@web.de  or  jeffbeck@linuxmuster.net

# modules
use strict;
use Getopt::Long;
Getopt::Long::Configure ("bundling");
use Sophomorix::SophomorixBase qw(
                                 print_line
                                 print_title
                                 check_options
                                 get_passwd_charlist
                                 get_plain_password
                                 );
use Sophomorix::SophomorixSambaAD qw(
                                 AD_school_create
                                 AD_bind_admin
                                 AD_unbind_admin
                                 AD_user_create
                                 AD_group_create
                                 AD_group_addmember
                                 AD_user_kill
                                 AD_dns_get
                                 AD_object_search
                                 AD_debug_logdump
                                 AD_get_name_tokened
                                 AD_get_passwd
                                    );
use Sophomorix::SophomorixTest qw(
                                 AD_object_nonexist
                                 AD_test_object
                                 run_command
                                 directory_tree_test
                                 test_file_content
                                 start_fs_test
                                 end_fs_test
                                 NTACL_test
                                 );

$Conf::log_level=1;
my $help=0;
my $full=0;

my $add_users=0;
my $test_add_users=0;

my $exammode_users=0;
my $test_exammode_users=0;

my $file_transfer_scopy=0;

my $file_transfer_share=0;
my $test_file_transfer_share=0;

my $file_transfer_collect_copy=0;
my $test_file_transfer_collect_copy=0;

my $file_transfer_collect_move=0;
my $test_file_transfer_collect_move=0;

my $file_transfer_clean=0;
my $test_file_transfer_clean=0;

my $file_transfer_home=0;
my $test_file_transfer_home=0;

my $file_transfer_home_clean=0;
my $test_file_transfer_home_clean=0;

my $nonexammode_users=0;
my $test_nonexammode_users=0;

my $kill_users=0;
my $test_kill_users=0;



my $all_options="";
my $json=0;
my %fs_test_result=();


my $testopt=GetOptions(
           "help|h" => \$help,
           "full|f" => \$full,
           "add-users" => \$add_users,
           "test-add-users" => \$test_add_users,
           "exammode-users" => \$exammode_users,
           "test-exammode-users" => \$test_exammode_users,
           "file-transfer-scopy" => \$file_transfer_scopy,
           "file-transfer-share" => \$file_transfer_share,
           "test-file-transfer-share" => \$test_file_transfer_share,
           "file-transfer-collect-copy" => \$file_transfer_collect_copy,
           "test-file-transfer-collect-copy" => \$test_file_transfer_collect_copy,
           "file-transfer-collect-move" => \$file_transfer_collect_move,
           "test-file-transfer-collect-move" => \$test_file_transfer_collect_move,
           "file-transfer-clean" => \$file_transfer_clean,
           "test-file-transfer-clean" => \$test_file_transfer_clean,
           "file-transfer-home" => \$file_transfer_home,
           "test-file-transfer-home" => \$test_file_transfer_home,
           "file-transfer-home-clean" => \$file_transfer_home_clean,
           "test-file-transfer-home-clean" => \$test_file_transfer_home_clean,
           "nonexammode-users" => \$nonexammode_users,
           "test-nonexammode-users" => \$test_nonexammode_users,
           "kill-users" => \$kill_users,
           "test-kill-users" => \$test_kill_users,
           "verbose|v+" => \$Conf::log_level,
           "json|j+" => \$json,
  );


# Prüfen, ob Optionen erkannt wurden, sonst Abbruch
&check_options($testopt);

if ($Conf::log_level==1){
    $all_options="";
} elsif ($Conf::log_level==2){
    $all_options="-v";
} elsif ($Conf::log_level==3){
    $all_options="-vv";
}

if ($json==0){
    # nothing to do
} elsif ($json==1){
    $all_options=$all_options." -j";
} elsif ($json==2){
    $all_options=$all_options." -jj";
} elsif ($json==3){
    $all_options=$all_options." -jjj";
} 

my ($ldap,$root_dse) = &AD_bind_admin();
my $root_dns=&AD_dns_get($root_dse);
my ($smb_admin_pass)=&AD_get_passwd($DevelConf::sophomorix_file_admin,
                                     $DevelConf::secret_file_sophomorix_file_admin);

my $testdata="/usr/share/sophomorix-developer/testdata";

# --help
if ($help==1) {
   # Scriptname ermitteln
   my @list = split(/\//,$0);
   my $scriptname = pop @list;
   # Befehlsbeschreibung
   print('
sophomorix-test-exammode tests exams

Options
  -h  / --help

   Add some users:
    sophomorix-test-exammode --add-users  
    sophomorix-test-exammode --test-add-users  

   Put some users in exammode:
    sophomorix-test-exammode --exammode-users  
    sophomorix-test-exammode --test-exammode-users  

   File transfer:
    sophomorix-test-exammode --file-transfer-scopy  (includes tests) 

    sophomorix-test-exammode --file-transfer-share 
    sophomorix-test-exammode --test-file-transfer-share 

    sophomorix-test-exammode --file-transfer-collect-copy 
    sophomorix-test-exammode --test-file-transfer-collect-copy 

    sophomorix-test-exammode --file-transfer-collect-move 
    sophomorix-test-exammode --test-file-transfer-collect-move 

    sophomorix-test-exammode --file-transfer-clean 
    sophomorix-test-exammode --test-file-transfer-clean 

   File transfer into home:
    sophomorix-test-exammode --file-transfer-home 
    sophomorix-test-exammode --test-file-transfer-home 

    sophomorix-test-exammode --file-transfer-home-clean 
    sophomorix-test-exammode --test-file-transfer-home-clean 

   Remove some users from exammode:
    sophomorix-test-exammode --nonexammode-users  
    sophomorix-test-exammode --test-nonexammode-users  

   Kill all users:
    sophomorix-test-exammode --kill-users  
    sophomorix-test-exammode --test-kill-users  

');
   print "\n";
   exit;
}





############################################################
# Check preliminaries
############################################################

# --full
if ($full==1){
    $add_users=1;
    $test_add_users=1;
    $exammode_users=1;
    $test_exammode_users=1;

    $file_transfer_share=1;
    $test_file_transfer_share=1;

    $file_transfer_scopy=1;

    $file_transfer_collect_copy=1;
    $test_file_transfer_collect_copy=1;

    $file_transfer_collect_move=1;
    $test_file_transfer_collect_move=1;

    $file_transfer_clean=1;
    $test_file_transfer_clean=1;

    $file_transfer_home=1;
    $test_file_transfer_home=1;
    $file_transfer_home_clean=1;
    $test_file_transfer_home_clean=1;

    $nonexammode_users=1;
    $test_nonexammode_users=1;
    $kill_users=1;
    $test_kill_users=1;
}

my $file_add_users=$testdata."/sophomorix.add-exammode";
my $file_kill_users=$testdata."/sophomorix.kill-exammode";
my $file_add="/var/lib/sophomorix/check-result/sophomorix.add";
my $file_kill="/var/lib/sophomorix/check-result/sophomorix.kill";


############################################################
# Add users
############################################################
# --add-users  
if ($add_users==1){
    # adding users
    &run_command("cp -v $file_add_users $file_add");
    &run_command("sophomorix-add $all_options");
}






############################################################
# Test users
############################################################
if ($test_add_users==1){
    ##### Testing the users
    # maiersa72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa72,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa72",
                   sAMAccountname=>"maiersa72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\maiersa72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/students/m7ab/maiersa72",
                   sn=>"Maier",
                   userPrincipalName => "maiersa72@".$root_dns,
                   mail => "maiersa72@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.students.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m7ab,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m7ab",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   mail => "bsz-m7ab@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   mail => "bsz-students@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-students",
                  });


    # muellegr72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=muellegr72,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Gregor Müller",
                   givenName=>"Gregor",
                   name=>"muellegr72",
                   sAMAccountname=>"muellegr72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\muellegr72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/students/m7ab/muellegr72",
                   sn=>"Müller",
                   userPrincipalName => "muellegr72@".$root_dns,
                   mail => "muellegr72@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster72!",
                   sophomorixFirstnameASCII => "Gregor",
                   sophomorixSurnameASCII  => "Mueller",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.students.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid2345",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m7ab,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m7ab",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   mail => "bsz-m7ab@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   mail => "bsz-students@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-students",
                  });


    # jonsonad72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=jonsonad72,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Aðalráður Jónsson",
                   givenName=>"Aðalráður",
                   name=>"jonsonad72",
                   sAMAccountname=>"jonsonad72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m8cd\\jonsonad72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                   sn=>"Jónsson",
                   userPrincipalName => "jonsonad72@".$root_dns,
                   mail => "jonsonad72@".$root_dns,
                   sophomorixAdminClass => "bsz-m8cd",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster72!",
                   sophomorixFirstnameASCII => "Adalradur",
                   sophomorixSurnameASCII  => "Jonsson",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.students.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid3456",
                   userAccountControl => "512",
                   memberOf => "bsz-m8cd|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m8cd,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m8cd",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   mail => "bsz-m8cd@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   mail => "bsz-students@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-students",
                  });


    # samardze72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=samardze72,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Željko Samardžić",
                   givenName=>"Željko",
                   name=>"samardze72",
                   sAMAccountname=>"samardze72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m8cd\\samardze72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/students/m8cd/samardze72",
                   sn=>"Samardžić",
                   userPrincipalName => "samardze72@".$root_dns,
                   mail => "samardze72@".$root_dns,
                   sophomorixAdminClass => "bsz-m8cd",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Zeljko",
                   sophomorixSurnameASCII  => "Samardzic",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.students.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid4567",
                   userAccountControl => "512",
                   memberOf => "bsz-m8cd|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m8cd,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m8cd",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   mail => "bsz-m8cd@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   mail => "bsz-students@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-students",
                  });


    # oe72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=oe72,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Gökhan Ömür",
                   givenName=>"Gökhan",
                   name=>"oe72",
                   sAMAccountname=>"oe72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\teachers\\oe72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/teachers/oe72",
                   sn=>"Ömür",
                   userPrincipalName => "oe72@".$root_dns,
                   mail => "oe72@".$root_dns,
                   sophomorixAdminClass => "bsz-teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster72!",
                   sophomorixFirstnameASCII => "Goekhan",
                   sophomorixSurnameASCII  => "Oemuer",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.teachers.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid5678",
                   userAccountControl => "512",
                   memberOf => "bsz-teachers|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "",
                  });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-teachers,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   mail => "bsz-teachers@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-teachers",
                  });


    # wu72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=wu72,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Désirée Würth",
                   givenName=>"Désirée",
                   name=>"wu72",
                   sAMAccountname=>"wu72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\teachers\\wu72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/teachers/wu72",
                   sn=>"Würth",
                   userPrincipalName => "wu72@".$root_dns,
                   mail => "wu72@".$root_dns,
                   sophomorixAdminClass => "bsz-teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster!",
                   sophomorixFirstnameASCII => "Desiree",
                   sophomorixSurnameASCII  => "Wuerth",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.teachers.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid6789",
                   userAccountControl => "512",
                   memberOf => "bsz-teachers|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "",
                  });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-teachers,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   mail => "bsz-teachers@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-teachers",
                  });

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result); 
    &directory_tree_test("/srv/samba/schools",
                         \%fs_test_result,
                         "/srv/samba/schools",
                         "/srv/samba/schools/abc",
                         "/srv/samba/schools/lin",
                         "/srv/samba/schools/ghs",
                         "/srv/samba/schools/bsz",
                         "/srv/samba/schools/bsz/management",
                         "/srv/samba/schools/bsz/share",     
                         "/srv/samba/schools/bsz/iso",
                         "/srv/samba/schools/bsz/program",     
                         "/srv/samba/schools/bsz/examusers",
                         "/srv/samba/schools/bsz/share/projects",
                         "/srv/samba/schools/bsz/students",
                         "/srv/samba/schools/bsz/teachers",
                         "/srv/samba/schools/bsz/teachers/oe72",
                         "/srv/samba/schools/bsz/teachers/oe72/transfer",
#                         "/srv/samba/schools/bsz/teachers/oe72/_einsammeln",
                         "/srv/samba/schools/bsz/teachers/wu72",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer",
#                         "/srv/samba/schools/bsz/teachers/wu72/_einsammeln",
                         "/srv/samba/schools/bsz/share/teachers",
                         "/srv/samba/schools/bsz/share/classes",                                      # ntacl
                         "/srv/samba/schools/bsz/share/management",                                      # ntacl
                         "/srv/samba/schools/bsz/share/school",                                      # ntacl
                         "/srv/samba/schools/bsz/students/m7ab",
                         "/srv/samba/schools/bsz/share/classes/m7ab",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer",
#                         "/srv/samba/schools/bsz/students/m7ab/maiersa72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72/transfer",
#                         "/srv/samba/schools/bsz/students/m7ab/muellegr72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m8cd",
                         "/srv/samba/schools/bsz/share/classes/m8cd",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/transfer",
#                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72/transfer",
#                         "/srv/samba/schools/bsz/students/m8cd/samardze72/_einsammeln",
                         "/srv/samba/schools/uni",
                         "/srv/samba/schools/uni/management",
                         "/srv/samba/schools/uni/share",     
                         "/srv/samba/schools/uni/iso",
                         "/srv/samba/schools/uni/program",     
                         "/srv/samba/schools/uni/examusers",
                         "/srv/samba/schools/uni/share/projects",
                         "/srv/samba/schools/uni/students",
                         "/srv/samba/schools/uni/students/12abc",
                         "/srv/samba/schools/uni/share/classes/12abc",
                         "/srv/samba/schools/uni/students/12abc/lordjo72",
                         "/srv/samba/schools/uni/students/12abc/lordjo72/transfer",
#                         "/srv/samba/schools/uni/students/12abc/lordjo72/_einsammeln",
                         "/srv/samba/schools/uni/students/12abc/blackmri72",
                         "/srv/samba/schools/uni/students/12abc/blackmri72/transfer",
#                         "/srv/samba/schools/uni/students/12abc/blackmri72/_einsammeln",
                         "/srv/samba/schools/uni/teachers",
                         "/srv/samba/schools/uni/teachers/kep72",
                         "/srv/samba/schools/uni/teachers/kep72/transfer",
#                         "/srv/samba/schools/uni/teachers/kep72/_einsammeln",
                         "/srv/samba/schools/uni/teachers/gal72",
                         "/srv/samba/schools/uni/teachers/gal72/transfer",
#                         "/srv/samba/schools/uni/teachers/gal72/_einsammeln",
                         "/srv/samba/schools/uni/share/teachers",
                         "/srv/samba/schools/uni/share/classes",                                      # ntacl
                         "/srv/samba/schools/uni/share/management",                                      # ntacl
                         "/srv/samba/schools/uni/share/school",                                      # ntacl
                         "/srv/samba/schools/default-school",
                         "/srv/samba/schools/default-school/management",
                         "/srv/samba/schools/default-school/share",
                         "/srv/samba/schools/default-school/iso",
                         "/srv/samba/schools/default-school/program",
                         "/srv/samba/schools/default-school/examusers",
                         "/srv/samba/schools/default-school/share/projects",
                         "/srv/samba/schools/default-school/students",
                         "/srv/samba/schools/default-school/students/s6ade",
                         "/srv/samba/schools/default-school/share/classes/s6ade",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72/transfer",
#                         "/srv/samba/schools/default-school/students/s6ade/schneima72/_einsammeln",
                         "/srv/samba/schools/default-school/teachers",
                         "/srv/samba/schools/default-school/teachers/sch72",
                         "/srv/samba/schools/default-school/teachers/sch72/transfer",
#                         "/srv/samba/schools/default-school/teachers/sch72/_einsammeln",
                         "/srv/samba/schools/default-school/share/teachers",
                         "/srv/samba/schools/default-school/share/classes",                           # ntacl
                         "/srv/samba/schools/default-school/share/management",                                      # ntacl
                         "/srv/samba/schools/default-school/share/school",                                      # ntacl
                        ); 
    &end_fs_test(\%fs_test_result);

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result);
    &directory_tree_test("/srv/samba/global",
                         \%fs_test_result,
                         "/srv/samba/global",
                         "/srv/samba/global/management",
                         "/srv/samba/global/share",
                         "/srv/samba/global/program",
                         "/srv/samba/global/iso",
                         "/srv/samba/global/share/projects",
                         "/srv/samba/global/share/management",         # ntacl
                         "/srv/samba/global/share/global",         # ntacl
                         "/srv/samba/global/students",
                         "/srv/samba/global/teachers",
                        ); 
    &end_fs_test(\%fs_test_result);
}


############################################################
# Set users in exammode
############################################################
if ($exammode_users==1){
    
    # add a 3 sessions
    # 666
    &run_command("sophomorix-session $all_options --create --supervisor oe72 --developer-session 666");
    &run_command("sophomorix-session $all_options --session 666 --participants muellegr72,maiersa72");
    # 777
    &run_command("sophomorix-session $all_options --create --supervisor wu72 --developer-session 777");
    &run_command("sophomorix-session $all_options --session 777 --participants jonsonad72,samardze72");
    sleep 1;

    # 888 with a comment
    &run_command("sophomorix-session $all_options --create --supervisor wu72 --developer-session 888 --comment \"Monday session\"");
    &run_command("sophomorix-session $all_options --session 888 --participants muellegr72,samardze72");

    # put the session members in exammode
    # 666
    &run_command("sophomorix-exam-mode --set --subdir-examuser subdir72 --supervisor oe72  --participants maiersa72,muellegr72 $all_options");
    # 777
    &run_command("sophomorix-exam-mode --set --supervisor wu72  --participants jonsonad72,samardze72 $all_options");
}




############################################################
# Test users in exammode
############################################################
if ($test_exammode_users==1){
    ##### Testing the users
    # maiersa72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa72,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa72",
                   sAMAccountname=>"maiersa72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\maiersa72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/students/m7ab/maiersa72",
                   sn=>"Maier",
                   userPrincipalName => "maiersa72@".$root_dns,
                   mail => "maiersa72@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.students.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "oe72",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "514",
                   memberOf => "bsz-m7ab|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "",
                  });
    # maiersa72-exam
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa72-exam,OU=subdir72,OU=Examusers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Examuser of Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa72-exam",
                   sAMAccountname=>"maiersa72-exam",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\examusers\\subdir72\\maiersa72-exam",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam",
                   sn=>"Maier",
                   userPrincipalName => "maiersa72-exam@".$root_dns,
                   mail => "maiersa72-exam@".$root_dns,
                   sophomorixAdminClass => "---",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "---",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixRole => "examuser",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "---",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "oe72",
                   sophomorixStatus=>"X",
                   sophomorixUnid => "---",
                   userAccountControl => "512",
                   memberOf => "bsz-examusers",
                   sophomorixSessions => "",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m7ab,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m7ab",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   mail => "bsz-m7ab@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   mail => "bsz-students@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-students",
                  });


    # muellegr72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=muellegr72,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Gregor Müller",
                   givenName=>"Gregor",
                   name=>"muellegr72",
                   sAMAccountname=>"muellegr72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\muellegr72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/students/m7ab/muellegr72",
                   sn=>"Müller",
                   userPrincipalName => "muellegr72@".$root_dns,
                   mail => "muellegr72@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster72!",
                   sophomorixFirstnameASCII => "Gregor",
                   sophomorixSurnameASCII  => "Mueller",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.students.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "oe72",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid2345",
                   userAccountControl => "514",
                   memberOf => "bsz-m7ab|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "",
                  });
    # muellegr72-exam
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=muellegr72-exam,OU=subdir72,OU=Examusers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Examuser of Gregor Müller",
                   givenName=>"Gregor",
                   name=>"muellegr72-exam",
                   sAMAccountname=>"muellegr72-exam",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\examusers\\subdir72\\muellegr72-exam",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam",
                   sn=>"Müller",
                   userPrincipalName => "muellegr72-exam@".$root_dns,
                   mail => "muellegr72-exam@".$root_dns,
                   sophomorixAdminClass => "---",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "---",
                   sophomorixFirstnameASCII => "Gregor",
                   sophomorixSurnameASCII  => "Mueller",
                   sophomorixRole => "examuser",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "---",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "oe72",
                   sophomorixStatus=>"X",
                   sophomorixUnid => "---",
                   userAccountControl => "512",
                   memberOf => "bsz-examusers",
                   sophomorixSessions => "",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m7ab,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m7ab",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   mail => "bsz-m7ab@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   mail => "bsz-students@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-students",
                  });


    # jonsonad72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=jonsonad72,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Aðalráður Jónsson",
                   givenName=>"Aðalráður",
                   name=>"jonsonad72",
                   sAMAccountname=>"jonsonad72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m8cd\\jonsonad72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                   sn=>"Jónsson",
                   userPrincipalName => "jonsonad72@".$root_dns,
                   mail => "jonsonad72@".$root_dns,
                   sophomorixAdminClass => "bsz-m8cd",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster72!",
                   sophomorixFirstnameASCII => "Adalradur",
                   sophomorixSurnameASCII  => "Jonsson",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.students.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "wu72",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid3456",
                   userAccountControl => "514",
                   memberOf => "bsz-m8cd|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "",
                  });
    # jonsonad72-exam
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=jonsonad72-exam,OU=Examusers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Examuser of Aðalráður Jónsson",
                   givenName=>"Aðalráður",
                   name=>"jonsonad72-exam",
                   sAMAccountname=>"jonsonad72-exam",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\examusers\\jonsonad72-exam",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/examusers/jonsonad72-exam",
                   sn=>"Jónsson",
                   userPrincipalName => "jonsonad72-exam@".$root_dns,
                   mail => "jonsonad72-exam@".$root_dns,
                   sophomorixAdminClass => "---",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "---",
                   sophomorixFirstnameASCII => "Adalradur",
                   sophomorixSurnameASCII  => "Jonsson",
                   sophomorixRole => "examuser",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "---",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "wu72",
                   sophomorixStatus=>"X",
                   sophomorixUnid => "---",
                   userAccountControl => "512",
                   memberOf => "bsz-examusers",
                   sophomorixSessions => "",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m8cd,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m8cd",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   mail => "bsz-m8cd@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   mail => "bsz-students@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-students",
                  });


    # samardze72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=samardze72,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Željko Samardžić",
                   givenName=>"Željko",
                   name=>"samardze72",
                   sAMAccountname=>"samardze72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m8cd\\samardze72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/students/m8cd/samardze72",
                   sn=>"Samardžić",
                   userPrincipalName => "samardze72@".$root_dns,
                   mail => "samardze72@".$root_dns,
                   sophomorixAdminClass => "bsz-m8cd",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Zeljko",
                   sophomorixSurnameASCII  => "Samardzic",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.students.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "wu72",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid4567",
                   userAccountControl => "514",
                   memberOf => "bsz-m8cd|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "",
                  });
    # samardze72-exam
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=samardze72-exam,OU=Examusers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Examuser of Željko Samardžić",
                   givenName=>"Željko",
                   name=>"samardze72-exam",
                   sAMAccountname=>"samardze72-exam",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\examusers\\samardze72-exam",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/examusers/samardze72-exam",
                   sn=>"Samardžić",
                   userPrincipalName => "samardze72-exam@".$root_dns,
                   mail => "samardze72-exam@".$root_dns,
                   sophomorixAdminClass => "---",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "---",
                   sophomorixFirstnameASCII => "Zeljko",
                   sophomorixSurnameASCII  => "Samardzic",
                   sophomorixRole => "examuser",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "---",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "wu72",
                   sophomorixStatus=>"X",
                   sophomorixUnid => "---",
                   userAccountControl => "512",
                   memberOf => "bsz-examusers",
                   sophomorixSessions => "",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m8cd,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m8cd",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   mail => "bsz-m8cd@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   mail => "bsz-students@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-students",
                  });


    # oe72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=oe72,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Gökhan Ömür",
                   givenName=>"Gökhan",
                   name=>"oe72",
                   sAMAccountname=>"oe72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\teachers\\oe72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/teachers/oe72",
                   sn=>"Ömür",
                   userPrincipalName => "oe72@".$root_dns,
                   mail => "oe72@".$root_dns,
                   sophomorixAdminClass => "bsz-teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster72!",
                   sophomorixFirstnameASCII => "Goekhan",
                   sophomorixSurnameASCII  => "Oemuer",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.teachers.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid5678",
                   userAccountControl => "512",
                   memberOf => "bsz-teachers|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "666;;muellegr72,maiersa72;",
                  });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-teachers,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   mail => "bsz-teachers@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-teachers",
                  });


    # wu72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=wu72,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Désirée Würth",
                   givenName=>"Désirée",
                   name=>"wu72",
                   sAMAccountname=>"wu72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\teachers\\wu72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/teachers/wu72",
                   sn=>"Würth",
                   userPrincipalName => "wu72@".$root_dns,
                   mail => "wu72@".$root_dns,
                   sophomorixAdminClass => "bsz-teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster!",
                   sophomorixFirstnameASCII => "Desiree",
                   sophomorixSurnameASCII  => "Wuerth",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.teachers.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid6789",
                   userAccountControl => "512",
                   memberOf => "bsz-teachers|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "777;;jonsonad72,samardze72;|888;Monday session;muellegr72,samardze72;",
                  });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-teachers,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   mail => "bsz-teachers@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-teachers",
                  });

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result); 
    &directory_tree_test("/srv/samba/schools",
                         \%fs_test_result,
                         "/srv/samba/schools",
                         "/srv/samba/schools/abc",
                         "/srv/samba/schools/lin",
                         "/srv/samba/schools/ghs",
                         "/srv/samba/schools/bsz",
                         "/srv/samba/schools/bsz/management",
                         "/srv/samba/schools/bsz/share",     
                         "/srv/samba/schools/bsz/iso",
                         "/srv/samba/schools/bsz/program",     
                         "/srv/samba/schools/bsz/examusers",
                         "/srv/samba/schools/bsz/examusers/subdir72",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer",
#                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/_einsammeln",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer",
#                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/_einsammeln",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer",
#                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam/_einsammeln",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer",
#                         "/srv/samba/schools/bsz/examusers/samardze72-exam/_einsammeln",
                         "/srv/samba/schools/bsz/share/projects",
                         "/srv/samba/schools/bsz/students",
                         "/srv/samba/schools/bsz/teachers",
                         "/srv/samba/schools/bsz/teachers/oe72",
                         "/srv/samba/schools/bsz/teachers/oe72/transfer",
#                         "/srv/samba/schools/bsz/teachers/oe72/_einsammeln",
                         "/srv/samba/schools/bsz/teachers/wu72",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer",
#                         "/srv/samba/schools/bsz/teachers/wu72/_einsammeln",
                         "/srv/samba/schools/bsz/share/teachers",
                         "/srv/samba/schools/bsz/share/classes",                                      # ntacl
                         "/srv/samba/schools/bsz/share/management",                                      # ntacl
                         "/srv/samba/schools/bsz/share/school",                                      # ntacl
                         "/srv/samba/schools/bsz/students/m7ab",
                         "/srv/samba/schools/bsz/share/classes/m7ab",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer",
#                         "/srv/samba/schools/bsz/students/m7ab/maiersa72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72/transfer",
#                         "/srv/samba/schools/bsz/students/m7ab/muellegr72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m8cd",
                         "/srv/samba/schools/bsz/share/classes/m8cd",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/transfer",
#                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72/transfer",
#                         "/srv/samba/schools/bsz/students/m8cd/samardze72/_einsammeln",
                         "/srv/samba/schools/uni",
                         "/srv/samba/schools/uni/management",
                         "/srv/samba/schools/uni/share",     
                         "/srv/samba/schools/uni/iso",
                         "/srv/samba/schools/uni/program",     
                         "/srv/samba/schools/uni/examusers",
                         "/srv/samba/schools/uni/share/projects",
                         "/srv/samba/schools/uni/students",
                         "/srv/samba/schools/uni/students/12abc",
                         "/srv/samba/schools/uni/share/classes/12abc",
                         "/srv/samba/schools/uni/students/12abc/lordjo72",
                         "/srv/samba/schools/uni/students/12abc/lordjo72/transfer",
#                         "/srv/samba/schools/uni/students/12abc/lordjo72/_einsammeln",
                         "/srv/samba/schools/uni/students/12abc/blackmri72",
                         "/srv/samba/schools/uni/students/12abc/blackmri72/transfer",
#                         "/srv/samba/schools/uni/students/12abc/blackmri72/_einsammeln",
                         "/srv/samba/schools/uni/teachers",
                         "/srv/samba/schools/uni/teachers/kep72",
                         "/srv/samba/schools/uni/teachers/kep72/transfer",
#                         "/srv/samba/schools/uni/teachers/kep72/_einsammeln",
                         "/srv/samba/schools/uni/teachers/gal72",
                         "/srv/samba/schools/uni/teachers/gal72/transfer",
#                         "/srv/samba/schools/uni/teachers/gal72/_einsammeln",
                         "/srv/samba/schools/uni/share/teachers",
                         "/srv/samba/schools/uni/share/classes",                                      # ntacl
                         "/srv/samba/schools/uni/share/management",                                      # ntacl
                         "/srv/samba/schools/uni/share/school",                                      # ntacl
                         "/srv/samba/schools/default-school",
                         "/srv/samba/schools/default-school/management",
                         "/srv/samba/schools/default-school/share",
                         "/srv/samba/schools/default-school/iso",
                         "/srv/samba/schools/default-school/program",
                         "/srv/samba/schools/default-school/examusers",
                         "/srv/samba/schools/default-school/share/projects",
                         "/srv/samba/schools/default-school/students",
                         "/srv/samba/schools/default-school/students/s6ade",
                         "/srv/samba/schools/default-school/share/classes/s6ade",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72/transfer",
#                         "/srv/samba/schools/default-school/students/s6ade/schneima72/_einsammeln",
                         "/srv/samba/schools/default-school/teachers",
                         "/srv/samba/schools/default-school/teachers/sch72",
                         "/srv/samba/schools/default-school/teachers/sch72/transfer",
#                         "/srv/samba/schools/default-school/teachers/sch72/_einsammeln",
                         "/srv/samba/schools/default-school/share/teachers",
                         "/srv/samba/schools/default-school/share/classes",                           # ntacl
                         "/srv/samba/schools/default-school/share/management",                                      # ntacl
                         "/srv/samba/schools/default-school/share/school",                                      # ntacl
                        ); 
# Testing NTACLs of exam users
    # /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam
    &NTACL_test ("bsz",
                 "/examusers/subdir72/maiersa72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\maiersa72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/subdir72/maiersa72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam
    &NTACL_test ("bsz",
                 "/examusers/subdir72/muellegr72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\muellegr72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/subdir72/muellegr72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/jonsonad72-exam
    &NTACL_test ("bsz",
                 "/examusers/jonsonad72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\jonsonad72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/jonsonad72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/samardze72-exam
    &NTACL_test ("bsz",
                 "/examusers/samardze72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\samardze72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/samardze72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/samardze72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    &end_fs_test(\%fs_test_result);

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result);
    &directory_tree_test("/srv/samba/global",
                         \%fs_test_result,
                         "/srv/samba/global",
                         "/srv/samba/global/management",
                         "/srv/samba/global/share",
                         "/srv/samba/global/program",
                         "/srv/samba/global/iso",
                         "/srv/samba/global/share/projects",
                         "/srv/samba/global/share/management",         # ntacl
                         "/srv/samba/global/share/global",         # ntacl
                         "/srv/samba/global/students",
                         "/srv/samba/global/teachers",
                        ); 
    &end_fs_test(\%fs_test_result);
}



############################################################
# do the file transfer, scopy
############################################################
if ($file_transfer_scopy==1){
    # create some files/dirs at user wu72
    &run_command("cp /usr/share/sophomorix-developer/testfiles/testfile-01.txt /srv/samba/schools/bsz/teachers/wu72");
    &run_command("cp /usr/share/sophomorix-developer/testfiles/testfile-02.txt /srv/samba/schools/bsz/teachers/wu72");
    &run_command("cp /usr/share/sophomorix-developer/testfiles/testfile-03.txt /srv/samba/schools/bsz/teachers/wu72");
    &run_command("mkdir /srv/samba/schools/bsz/teachers/wu72/testdir-01");
    &run_command("mkdir /srv/samba/schools/bsz/teachers/wu72/testdir-02");
    &run_command("mkdir /srv/samba/schools/bsz/teachers/wu72/testdir-03");
    &run_command("cp /usr/share/sophomorix-developer/testfiles/testfile-01-01.txt /srv/samba/schools/bsz/teachers/wu72/testdir-01");
    &run_command("cp /usr/share/sophomorix-developer/testfiles/testfile-01-02.txt /srv/samba/schools/bsz/teachers/wu72/testdir-01");
    &run_command("cp /usr/share/sophomorix-developer/testfiles/testfile-01-03.txt /srv/samba/schools/bsz/teachers/wu72/testdir-01");

    &run_command("mkdir /srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-01");
    &run_command("cp /usr/share/sophomorix-developer/testfiles/testfile-01-01-01.txt /srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-01");
    &run_command("cp /usr/share/sophomorix-developer/testfiles/testfile-01-01-02.txt /srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-01");

    &run_command("mkdir /srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-02");
    &run_command("mkdir /srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-03");

    &run_command("mkdir /srv/samba/schools/bsz/teachers/wu72/testdir-02/testdir-02-01");

    # create some files at user maiersa72-exam
    # the blocking file to mail copying a dir to this place
    &run_command("touch /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/blockfile.txt");

    # test file creation
    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result); 
    &directory_tree_test("/srv/samba/schools",
                         \%fs_test_result,
                         "/srv/samba/schools",
                         "/srv/samba/schools/abc",
                         "/srv/samba/schools/lin",
                         "/srv/samba/schools/ghs",
                         "/srv/samba/schools/bsz",
                         "/srv/samba/schools/bsz/management",
                         "/srv/samba/schools/bsz/share",     
                         "/srv/samba/schools/bsz/iso",
                         "/srv/samba/schools/bsz/program",     
                         "/srv/samba/schools/bsz/examusers",
                         "/srv/samba/schools/bsz/examusers/subdir72",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/blockfile.txt",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer",
                         "/srv/samba/schools/bsz/share/projects",
                         "/srv/samba/schools/bsz/students",
                         "/srv/samba/schools/bsz/teachers",
                         "/srv/samba/schools/bsz/teachers/oe72",
                         "/srv/samba/schools/bsz/teachers/oe72/transfer",
                         "/srv/samba/schools/bsz/teachers/wu72",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer",
                         "/srv/samba/schools/bsz/teachers/wu72/testfile-01.txt",
                         "/srv/samba/schools/bsz/teachers/wu72/testfile-02.txt",
                         "/srv/samba/schools/bsz/teachers/wu72/testfile-03.txt",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-02",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-03",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-01",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-01/testfile-01-01-01.txt",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-01/testfile-01-01-02.txt",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-02",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-03",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-02/testdir-02-01",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testfile-01-01.txt",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testfile-01-02.txt",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testfile-01-03.txt",
                         "/srv/samba/schools/bsz/share/teachers",
                         "/srv/samba/schools/bsz/share/classes",
                         "/srv/samba/schools/bsz/share/management",
                         "/srv/samba/schools/bsz/share/school",
                         "/srv/samba/schools/bsz/students/m7ab",
                         "/srv/samba/schools/bsz/share/classes/m7ab",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72/transfer",
                         "/srv/samba/schools/bsz/students/m8cd",
                         "/srv/samba/schools/bsz/share/classes/m8cd",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/transfer",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72/transfer",
                         "/srv/samba/schools/uni",
                         "/srv/samba/schools/uni/management",
                         "/srv/samba/schools/uni/share",     
                         "/srv/samba/schools/uni/iso",
                         "/srv/samba/schools/uni/program",     
                         "/srv/samba/schools/uni/examusers",
                         "/srv/samba/schools/uni/share/projects",
                         "/srv/samba/schools/uni/students",
                         "/srv/samba/schools/uni/students/12abc",
                         "/srv/samba/schools/uni/share/classes/12abc",
                         "/srv/samba/schools/uni/students/12abc/lordjo72",
                         "/srv/samba/schools/uni/students/12abc/lordjo72/transfer",
                         "/srv/samba/schools/uni/students/12abc/blackmri72",
                         "/srv/samba/schools/uni/students/12abc/blackmri72/transfer",
                         "/srv/samba/schools/uni/teachers",
                         "/srv/samba/schools/uni/teachers/kep72",
                         "/srv/samba/schools/uni/teachers/kep72/transfer",
                         "/srv/samba/schools/uni/teachers/gal72",
                         "/srv/samba/schools/uni/teachers/gal72/transfer",
                         "/srv/samba/schools/uni/share/teachers",
                         "/srv/samba/schools/uni/share/classes",
                         "/srv/samba/schools/uni/share/management",
                         "/srv/samba/schools/uni/share/school",
                         "/srv/samba/schools/default-school",
                         "/srv/samba/schools/default-school/management",
                         "/srv/samba/schools/default-school/share",
                         "/srv/samba/schools/default-school/iso",
                         "/srv/samba/schools/default-school/program",
                         "/srv/samba/schools/default-school/examusers",
                         "/srv/samba/schools/default-school/share/projects",
                         "/srv/samba/schools/default-school/students",
                         "/srv/samba/schools/default-school/students/s6ade",
                         "/srv/samba/schools/default-school/share/classes/s6ade",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72/transfer",
                         "/srv/samba/schools/default-school/teachers",
                         "/srv/samba/schools/default-school/teachers/sch72",
                         "/srv/samba/schools/default-school/teachers/sch72/transfer",
                         "/srv/samba/schools/default-school/share/teachers",
                         "/srv/samba/schools/default-school/share/classes",
                         "/srv/samba/schools/default-school/share/management",
                         "/srv/samba/schools/default-school/share/school",
                        ); 

    &end_fs_test(\%fs_test_result);

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result);
    &directory_tree_test("/srv/samba/global",
                         \%fs_test_result,
                         "/srv/samba/global",
                         "/srv/samba/global/management",
                         "/srv/samba/global/share",
                         "/srv/samba/global/program",
                         "/srv/samba/global/iso",
                         "/srv/samba/global/share/projects",
                         "/srv/samba/global/share/management",
                         "/srv/samba/global/share/global",
                         "/srv/samba/global/students",
                         "/srv/samba/global/teachers",
                        ); 
    &end_fs_test(\%fs_test_result);

    ############################################################
    # Test A) source nonexisting (within school)
    &run_command("sophomorix-transfer $all_options --scopy --from-user wu72 --from-path transfer/77.txt --to-user jonsonad72-exam --to-path transfer"); 

    # Test B) cp file to NONEXISTING (within school)
    # copy file only
    &run_command("sophomorix-transfer $all_options --scopy --from-user wu72 --from-path testdir-01/testfile-01-01.txt --to-user jonsonad72-exam --to-path dir/to/new-filename.txt");
    # create parent dir and copy file 
    &run_command("sophomorix-transfer $all_options --scopy --from-user wu72 --from-path testdir-01/testfile-01-01.txt --to-user jonsonad72-exam --to-path topfile.txt"); 

    # C) file -> dir (copy into dir if no other dir is in the way)
    &run_command("sophomorix-transfer $all_options --scopy --from-user wu72 --from-path testfile-02.txt --to-user maiersa72-exam --to-path transfer");

    # D) dir -> file (error)
    &run_command("sophomorix-transfer $all_options --scopy --from-user wu72 --from-path testdir-01 --to-user maiersa72-exam --to-path blockfile.txt");

    # E) dir -> dir (copy recursively)
    # copy into transfer (results in muellegr72-exam/transfer/testdir-01)
    &run_command("sophomorix-transfer $all_options --scopy --from-user wu72 --from-path testdir-01 --to-user muellegr72-exam --to-path transfer");
    # use --no-target-directory 
    &run_command("sophomorix-transfer $all_options --scopy --from-user wu72 --from-path testdir-01 --to-user samardze72-exam --to-path transfer --no-target-directory");

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result); 
    &directory_tree_test("/srv/samba/schools",
                         \%fs_test_result,
                         "/srv/samba/schools",
                         "/srv/samba/schools/abc",
                         "/srv/samba/schools/lin",
                         "/srv/samba/schools/ghs",
                         "/srv/samba/schools/bsz",
                         "/srv/samba/schools/bsz/management",
                         "/srv/samba/schools/bsz/share",     
                         "/srv/samba/schools/bsz/iso",
                         "/srv/samba/schools/bsz/program",     
                         "/srv/samba/schools/bsz/examusers",
                         "/srv/samba/schools/bsz/examusers/subdir72",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/blockfile.txt",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer/testfile-02.txt",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/testdir-01",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/testdir-01/testdir-01-01",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/testdir-01/testdir-01-01/testfile-01-01-01.txt",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/testdir-01/testdir-01-01/testfile-01-01-02.txt",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/testdir-01/testdir-01-02",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/testdir-01/testdir-01-03",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/testdir-01/testfile-01-01.txt",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/testdir-01/testfile-01-02.txt",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/testdir-01/testfile-01-03.txt",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam/dir",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam/dir/to",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam/dir/to/new-filename.txt",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam/topfile.txt",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/testdir-01-01",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/testdir-01-01/testfile-01-01-01.txt",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/testdir-01-01/testfile-01-01-02.txt",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/testdir-01-02",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/testdir-01-03",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/testfile-01-01.txt",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/testfile-01-02.txt",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/testfile-01-03.txt",
                         "/srv/samba/schools/bsz/share/projects",
                         "/srv/samba/schools/bsz/students",
                         "/srv/samba/schools/bsz/teachers",
                         "/srv/samba/schools/bsz/teachers/oe72",
                         "/srv/samba/schools/bsz/teachers/oe72/transfer",
                         "/srv/samba/schools/bsz/teachers/wu72",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer",
                         "/srv/samba/schools/bsz/teachers/wu72/testfile-01.txt",
                         "/srv/samba/schools/bsz/teachers/wu72/testfile-02.txt",
                         "/srv/samba/schools/bsz/teachers/wu72/testfile-03.txt",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-02",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-03",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-01",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-01/testfile-01-01-01.txt",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-01/testfile-01-01-02.txt",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-02",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testdir-01-03",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-02/testdir-02-01",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testfile-01-01.txt",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testfile-01-02.txt",
                         "/srv/samba/schools/bsz/teachers/wu72/testdir-01/testfile-01-03.txt",
                         "/srv/samba/schools/bsz/share/teachers",
                         "/srv/samba/schools/bsz/share/classes",
                         "/srv/samba/schools/bsz/share/management",
                         "/srv/samba/schools/bsz/share/school",
                         "/srv/samba/schools/bsz/students/m7ab",
                         "/srv/samba/schools/bsz/share/classes/m7ab",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72/transfer",
                         "/srv/samba/schools/bsz/students/m8cd",
                         "/srv/samba/schools/bsz/share/classes/m8cd",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/transfer",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72/transfer",
                         "/srv/samba/schools/uni",
                         "/srv/samba/schools/uni/management",
                         "/srv/samba/schools/uni/share",     
                         "/srv/samba/schools/uni/iso",
                         "/srv/samba/schools/uni/program",     
                         "/srv/samba/schools/uni/examusers",
                         "/srv/samba/schools/uni/share/projects",
                         "/srv/samba/schools/uni/students",
                         "/srv/samba/schools/uni/students/12abc",
                         "/srv/samba/schools/uni/share/classes/12abc",
                         "/srv/samba/schools/uni/students/12abc/lordjo72",
                         "/srv/samba/schools/uni/students/12abc/lordjo72/transfer",
                         "/srv/samba/schools/uni/students/12abc/blackmri72",
                         "/srv/samba/schools/uni/students/12abc/blackmri72/transfer",
                         "/srv/samba/schools/uni/teachers",
                         "/srv/samba/schools/uni/teachers/kep72",
                         "/srv/samba/schools/uni/teachers/kep72/transfer",
                         "/srv/samba/schools/uni/teachers/gal72",
                         "/srv/samba/schools/uni/teachers/gal72/transfer",
                         "/srv/samba/schools/uni/share/teachers",
                         "/srv/samba/schools/uni/share/classes",
                         "/srv/samba/schools/uni/share/management",
                         "/srv/samba/schools/uni/share/school",
                         "/srv/samba/schools/default-school",
                         "/srv/samba/schools/default-school/management",
                         "/srv/samba/schools/default-school/share",
                         "/srv/samba/schools/default-school/iso",
                         "/srv/samba/schools/default-school/program",
                         "/srv/samba/schools/default-school/examusers",
                         "/srv/samba/schools/default-school/share/projects",
                         "/srv/samba/schools/default-school/students",
                         "/srv/samba/schools/default-school/students/s6ade",
                         "/srv/samba/schools/default-school/share/classes/s6ade",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72/transfer",
                         "/srv/samba/schools/default-school/teachers",
                         "/srv/samba/schools/default-school/teachers/sch72",
                         "/srv/samba/schools/default-school/teachers/sch72/transfer",
                         "/srv/samba/schools/default-school/share/teachers",
                         "/srv/samba/schools/default-school/share/classes",
                         "/srv/samba/schools/default-school/share/management",
                         "/srv/samba/schools/default-school/share/school",
                        ); 

    &end_fs_test(\%fs_test_result);

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result);
    &directory_tree_test("/srv/samba/global",
                         \%fs_test_result,
                         "/srv/samba/global",
                         "/srv/samba/global/management",
                         "/srv/samba/global/share",
                         "/srv/samba/global/program",
                         "/srv/samba/global/iso",
                         "/srv/samba/global/share/projects",
                         "/srv/samba/global/share/management",
                         "/srv/samba/global/share/global",
                         "/srv/samba/global/students",
                         "/srv/samba/global/teachers",
                        ); 
    &end_fs_test(\%fs_test_result);

    &test_file_content("/srv/samba/schools/bsz/examusers/jonsonad72-exam/topfile.txt","testfile-01-01.txt");
    &test_file_content("/srv/samba/schools/bsz/examusers/jonsonad72-exam/dir/to/new-filename.txt","testfile-01-01.txt");



    # Test if overwriting of a file works
    &run_command("sophomorix-transfer --scopy --from-user wu72 --from-path testdir-01/testfile-01-02.txt --to-user jonsonad72-exam --to-path topfile.txt"); 
    &test_file_content("/srv/samba/schools/bsz/examusers/jonsonad72-exam/topfile.txt","testfile-01-02.txt");

    # delete created files from B)
    &run_command("rm -rf /srv/samba/schools/bsz/examusers/jonsonad72-exam/dir");
    &run_command("rm -rf /srv/samba/schools/bsz/examusers/jonsonad72-exam/topfile.txt");
    # delete created files from B)
    &run_command("rm -rf /srv/samba/schools/bsz/examusers/maiersa72-exam/transfer/testfile-02.txt");

    # delete created files from C)
    &run_command("rm -rf /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer/testfile-02.txt");
    # delete created files from D)
    &run_command("rm -rf /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/blockfile.txt");

    # delete created files from E)
    &run_command("rm -rf /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/testdir-01");
    
    &run_command("rm -rf /srv/samba/schools/bsz/examusers/samardze72-exam/transfer/testdir-01-01");
    &run_command("rm -rf /srv/samba/schools/bsz/examusers/samardze72-exam/transfer/testdir-01-02");
    &run_command("rm -rf /srv/samba/schools/bsz/examusers/samardze72-exam/transfer/testdir-01-03");
    &run_command("rm -rf /srv/samba/schools/bsz/examusers/samardze72-exam/transfer/testfile-01-01.txt");
    &run_command("rm -rf /srv/samba/schools/bsz/examusers/samardze72-exam/transfer/testfile-01-02.txt");
    &run_command("rm -rf /srv/samba/schools/bsz/examusers/samardze72-exam/transfer/testfile-01-03.txt");

    ############################################################
    # delete dirs/files at user wu72
    ############################################################
    &run_command("rm -rf /srv/samba/schools/bsz/teachers/wu72/testdir-01");
    &run_command("rm -rf /srv/samba/schools/bsz/teachers/wu72/testdir-02");
    &run_command("rm -rf /srv/samba/schools/bsz/teachers/wu72/testdir-03");
    &run_command("rm -f /srv/samba/schools/bsz/teachers/wu72/testfile-01.txt");
    &run_command("rm -f /srv/samba/schools/bsz/teachers/wu72/testfile-02.txt");
    &run_command("rm -f /srv/samba/schools/bsz/teachers/wu72/testfile-03.txt");

    # Test file deletion
    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result); 
    &directory_tree_test("/srv/samba/schools",
                         \%fs_test_result,
                         "/srv/samba/schools",
                         "/srv/samba/schools/abc",
                         "/srv/samba/schools/lin",
                         "/srv/samba/schools/ghs",
                         "/srv/samba/schools/bsz",
                         "/srv/samba/schools/bsz/management",
                         "/srv/samba/schools/bsz/share",     
                         "/srv/samba/schools/bsz/iso",
                         "/srv/samba/schools/bsz/program",     
                         "/srv/samba/schools/bsz/examusers",
                         "/srv/samba/schools/bsz/examusers/subdir72",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer",
                         "/srv/samba/schools/bsz/share/projects",
                         "/srv/samba/schools/bsz/students",
                         "/srv/samba/schools/bsz/teachers",
                         "/srv/samba/schools/bsz/teachers/oe72",
                         "/srv/samba/schools/bsz/teachers/oe72/transfer",
                         "/srv/samba/schools/bsz/teachers/wu72",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer",
                         "/srv/samba/schools/bsz/share/teachers",
                         "/srv/samba/schools/bsz/share/classes",
                         "/srv/samba/schools/bsz/share/management",
                         "/srv/samba/schools/bsz/share/school",
                         "/srv/samba/schools/bsz/students/m7ab",
                         "/srv/samba/schools/bsz/share/classes/m7ab",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72/transfer",
                         "/srv/samba/schools/bsz/students/m8cd",
                         "/srv/samba/schools/bsz/share/classes/m8cd",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/transfer",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72/transfer",
                         "/srv/samba/schools/uni",
                         "/srv/samba/schools/uni/management",
                         "/srv/samba/schools/uni/share",     
                         "/srv/samba/schools/uni/iso",
                         "/srv/samba/schools/uni/program",     
                         "/srv/samba/schools/uni/examusers",
                         "/srv/samba/schools/uni/share/projects",
                         "/srv/samba/schools/uni/students",
                         "/srv/samba/schools/uni/students/12abc",
                         "/srv/samba/schools/uni/share/classes/12abc",
                         "/srv/samba/schools/uni/students/12abc/lordjo72",
                         "/srv/samba/schools/uni/students/12abc/lordjo72/transfer",
                         "/srv/samba/schools/uni/students/12abc/blackmri72",
                         "/srv/samba/schools/uni/students/12abc/blackmri72/transfer",
                         "/srv/samba/schools/uni/teachers",
                         "/srv/samba/schools/uni/teachers/kep72",
                         "/srv/samba/schools/uni/teachers/kep72/transfer",
                         "/srv/samba/schools/uni/teachers/gal72",
                         "/srv/samba/schools/uni/teachers/gal72/transfer",
                         "/srv/samba/schools/uni/share/teachers",
                         "/srv/samba/schools/uni/share/classes",
                         "/srv/samba/schools/uni/share/management",
                         "/srv/samba/schools/uni/share/school",
                         "/srv/samba/schools/default-school",
                         "/srv/samba/schools/default-school/management",
                         "/srv/samba/schools/default-school/share",
                         "/srv/samba/schools/default-school/iso",
                         "/srv/samba/schools/default-school/program",
                         "/srv/samba/schools/default-school/examusers",
                         "/srv/samba/schools/default-school/share/projects",
                         "/srv/samba/schools/default-school/students",
                         "/srv/samba/schools/default-school/students/s6ade",
                         "/srv/samba/schools/default-school/share/classes/s6ade",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72/transfer",
                         "/srv/samba/schools/default-school/teachers",
                         "/srv/samba/schools/default-school/teachers/sch72",
                         "/srv/samba/schools/default-school/teachers/sch72/transfer",
                         "/srv/samba/schools/default-school/share/teachers",
                         "/srv/samba/schools/default-school/share/classes",
                         "/srv/samba/schools/default-school/share/management",
                         "/srv/samba/schools/default-school/share/school",
                        ); 

    &end_fs_test(\%fs_test_result);

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result);
    &directory_tree_test("/srv/samba/global",
                         \%fs_test_result,
                         "/srv/samba/global",
                         "/srv/samba/global/management",
                         "/srv/samba/global/share",
                         "/srv/samba/global/program",
                         "/srv/samba/global/iso",
                         "/srv/samba/global/share/projects",
                         "/srv/samba/global/share/management",
                         "/srv/samba/global/share/global",
                         "/srv/samba/global/students",
                         "/srv/samba/global/teachers",
                        ); 
    &end_fs_test(\%fs_test_result);
}



############################################################
# do the file transfer, share
############################################################
if ($file_transfer_share==1){
    # share files
    &run_command("sophomorix-transfer $all_options --from-unix-path /usr/share/sophomorix-developer/testdata/transfer-testdata --to-user maiersa72,muellegr72-exam,samardze72-exam $all_options");

}



############################################################
# Test the file transfer
############################################################
if ($test_file_transfer_share==1){
    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result); 
    &directory_tree_test("/srv/samba/schools",
                    \%fs_test_result,
                    "/srv/samba/schools",
                    "/srv/samba/schools/abc",
                    "/srv/samba/schools/lin",
                    "/srv/samba/schools/ghs",
                    "/srv/samba/schools/bsz",
                    "/srv/samba/schools/bsz/management",
                    "/srv/samba/schools/bsz/share",     
                    "/srv/samba/schools/bsz/iso",
                    "/srv/samba/schools/bsz/program",     
                    "/srv/samba/schools/bsz/examusers",
                    "/srv/samba/schools/bsz/examusers/subdir72",
                    "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam",
                    "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer",
#                    "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/file1-level1",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/file2-level1",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir1-level1",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir1-level1/file1-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir1-level1/file2-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir1-level1/file3-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/file1-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/file2-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/file3-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/examusers/jonsonad72-exam",
                    "/srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer",
#                    "/srv/samba/schools/bsz/examusers/jonsonad72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/file1-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/file2-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file1-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file2-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file3-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file1-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file2-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file3-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/examusers/samardze72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/share/projects",
                    "/srv/samba/schools/bsz/students",
                    "/srv/samba/schools/bsz/teachers",
                    "/srv/samba/schools/bsz/teachers/oe72",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer",
#                    "/srv/samba/schools/bsz/teachers/oe72/_einsammeln",
                    "/srv/samba/schools/bsz/teachers/wu72",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer",
#                    "/srv/samba/schools/bsz/teachers/wu72/_einsammeln",
                    "/srv/samba/schools/bsz/share/teachers",
                    "/srv/samba/schools/bsz/share/classes",                                      # ntacl
                    "/srv/samba/schools/bsz/share/management",                                      # ntacl
                    "/srv/samba/schools/bsz/share/school",                                      # ntacl
                    "/srv/samba/schools/bsz/students/m7ab",
                    "/srv/samba/schools/bsz/share/classes/m7ab",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/file1-level1",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/file2-level1",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir1-level1",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir1-level1/file1-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir1-level1/file2-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir1-level1/file3-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/file1-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/file2-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/file3-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/_einsammeln",
                    "/srv/samba/schools/bsz/students/m7ab/muellegr72",
                    "/srv/samba/schools/bsz/students/m7ab/muellegr72/transfer",
#                    "/srv/samba/schools/bsz/students/m7ab/muellegr72/_einsammeln",
                    "/srv/samba/schools/bsz/students/m8cd",
                    "/srv/samba/schools/bsz/share/classes/m8cd",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/transfer",
#                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/_einsammeln",
                    "/srv/samba/schools/bsz/students/m8cd/samardze72",
                    "/srv/samba/schools/bsz/students/m8cd/samardze72/transfer",
#                    "/srv/samba/schools/bsz/students/m8cd/samardze72/_einsammeln",
                    "/srv/samba/schools/uni",
                    "/srv/samba/schools/uni/management",
                    "/srv/samba/schools/uni/share",     
                    "/srv/samba/schools/uni/iso",
                    "/srv/samba/schools/uni/program",     
                    "/srv/samba/schools/uni/examusers",
                    "/srv/samba/schools/uni/share/projects",
                    "/srv/samba/schools/uni/students",
                    "/srv/samba/schools/uni/students/12abc",
                    "/srv/samba/schools/uni/share/classes/12abc",
                    "/srv/samba/schools/uni/students/12abc/lordjo72",
                    "/srv/samba/schools/uni/students/12abc/lordjo72/transfer",
#                    "/srv/samba/schools/uni/students/12abc/lordjo72/_einsammeln",
                    "/srv/samba/schools/uni/students/12abc/blackmri72",
                    "/srv/samba/schools/uni/students/12abc/blackmri72/transfer",
#                    "/srv/samba/schools/uni/students/12abc/blackmri72/_einsammeln",
                    "/srv/samba/schools/uni/teachers",
                    "/srv/samba/schools/uni/teachers/kep72",
                    "/srv/samba/schools/uni/teachers/kep72/transfer",
#                    "/srv/samba/schools/uni/teachers/kep72/_einsammeln",
                    "/srv/samba/schools/uni/teachers/gal72",
                    "/srv/samba/schools/uni/teachers/gal72/transfer",
#                    "/srv/samba/schools/uni/teachers/gal72/_einsammeln",
                    "/srv/samba/schools/uni/share/teachers",
                    "/srv/samba/schools/uni/share/classes",                                      # ntacl
                    "/srv/samba/schools/uni/share/management",                                      # ntacl
                    "/srv/samba/schools/uni/share/school",                                      # ntacl
                    "/srv/samba/schools/default-school",
                    "/srv/samba/schools/default-school/management",
                    "/srv/samba/schools/default-school/share",
                    "/srv/samba/schools/default-school/iso",
                    "/srv/samba/schools/default-school/program",
                    "/srv/samba/schools/default-school/examusers",
                    "/srv/samba/schools/default-school/share/projects",
                    "/srv/samba/schools/default-school/students",
                    "/srv/samba/schools/default-school/students/s6ade",
                    "/srv/samba/schools/default-school/share/classes/s6ade",
                    "/srv/samba/schools/default-school/students/s6ade/schneima72",
                    "/srv/samba/schools/default-school/students/s6ade/schneima72/transfer",
#                    "/srv/samba/schools/default-school/students/s6ade/schneima72/_einsammeln",
                    "/srv/samba/schools/default-school/teachers",
                    "/srv/samba/schools/default-school/teachers/sch72",
                    "/srv/samba/schools/default-school/teachers/sch72/transfer",
#                    "/srv/samba/schools/default-school/teachers/sch72/_einsammeln",
                    "/srv/samba/schools/default-school/share/teachers",
                    "/srv/samba/schools/default-school/share/classes",                           # ntacl
                    "/srv/samba/schools/default-school/share/management",                                      # ntacl
                    "/srv/samba/schools/default-school/share/school",                                      # ntacl
                   ); 
# Testing NTACLs of exam users
    # /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam
    &NTACL_test ("bsz",
                 "/examusers/subdir72/maiersa72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\maiersa72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/subdir72/maiersa72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam
    &NTACL_test ("bsz",
                 "/examusers/subdir72/muellegr72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\muellegr72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/subdir72/muellegr72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/jonsonad72-exam
    &NTACL_test ("bsz",
                 "/examusers/jonsonad72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\jonsonad72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/jonsonad72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/samardze72-exam
    &NTACL_test ("bsz",
                 "/examusers/samardze72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\samardze72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/samardze72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/samardze72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    &end_fs_test(\%fs_test_result);

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result);
    &directory_tree_test("/srv/samba/global",
                         \%fs_test_result,
                         "/srv/samba/global",
                         "/srv/samba/global/management",
                         "/srv/samba/global/share",
                         "/srv/samba/global/program",
                         "/srv/samba/global/iso",
                         "/srv/samba/global/share/projects",
                         "/srv/samba/global/share/management",         # ntacl
                         "/srv/samba/global/share/global",         # ntacl
                         "/srv/samba/global/students",
                         "/srv/samba/global/teachers",
                        ); 
    &end_fs_test(\%fs_test_result);
}



############################################################
# do the file transfer, collect copy
############################################################
if ($file_transfer_collect_copy==1){
    # copy
    # collect dirs and files from default location 'transfer'
    &run_command("sophomorix-transfer $all_options --collect-copy --from-user maiersa72 --to-user oe72 --file transfer/file1-level1,transfer/file2-level1,transfer/subdir2-level1");
    # collect the whole directory 'transfer'
    &run_command("sophomorix-transfer $all_options --collect-copy --from-user muellegr72-exam --to-user kep72 --file transfer");
}



############################################################
# test the file transfer, collect copy
############################################################
if ($test_file_transfer_collect_copy==1){
    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result); 
    &directory_tree_test("/srv/samba/schools",
                    \%fs_test_result,
                    "/srv/samba/schools",
                    "/srv/samba/schools/abc",
                    "/srv/samba/schools/lin",
                    "/srv/samba/schools/ghs",
                    "/srv/samba/schools/bsz",
                    "/srv/samba/schools/bsz/management",
                    "/srv/samba/schools/bsz/share",     
                    "/srv/samba/schools/bsz/iso",
                    "/srv/samba/schools/bsz/program",     
                    "/srv/samba/schools/bsz/examusers",
                    "/srv/samba/schools/bsz/examusers/subdir72",
                    "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam",
                    "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer",
#                    "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/file1-level1",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/file2-level1",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir1-level1",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir1-level1/file1-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir1-level1/file2-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir1-level1/file3-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/file1-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/file2-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/file3-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/examusers/jonsonad72-exam",
                    "/srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer",
#                    "/srv/samba/schools/bsz/examusers/jonsonad72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/file1-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/file2-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file1-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file2-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file3-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file1-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file2-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file3-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/examusers/samardze72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/share/projects",
                    "/srv/samba/schools/bsz/students",
                    "/srv/samba/schools/bsz/teachers",
                    "/srv/samba/schools/bsz/teachers/oe72",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/file1-level1",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/file2-level1",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/file1-level2",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/file2-level2",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/file3-level2",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/teachers/oe72/_einsammeln",
                    "/srv/samba/schools/bsz/teachers/wu72",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer",
#                    "/srv/samba/schools/bsz/teachers/wu72/_einsammeln",
                    "/srv/samba/schools/bsz/share/teachers",
                    "/srv/samba/schools/bsz/share/classes",                                      # ntacl
                    "/srv/samba/schools/bsz/share/management",                                      # ntacl
                    "/srv/samba/schools/bsz/share/school",                                      # ntacl
                    "/srv/samba/schools/bsz/students/m7ab",
                    "/srv/samba/schools/bsz/share/classes/m7ab",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/file1-level1",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/file2-level1",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir1-level1",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir1-level1/file1-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir1-level1/file2-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir1-level1/file3-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/file1-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/file2-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/file3-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/_einsammeln",
                    "/srv/samba/schools/bsz/students/m7ab/muellegr72",
                    "/srv/samba/schools/bsz/students/m7ab/muellegr72/transfer",
#                    "/srv/samba/schools/bsz/students/m7ab/muellegr72/_einsammeln",
                    "/srv/samba/schools/bsz/students/m8cd",
                    "/srv/samba/schools/bsz/share/classes/m8cd",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/transfer",
#                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/_einsammeln",
                    "/srv/samba/schools/bsz/students/m8cd/samardze72",
                    "/srv/samba/schools/bsz/students/m8cd/samardze72/transfer",
#                    "/srv/samba/schools/bsz/students/m8cd/samardze72/_einsammeln",
                    "/srv/samba/schools/uni",
                    "/srv/samba/schools/uni/management",
                    "/srv/samba/schools/uni/share",     
                    "/srv/samba/schools/uni/iso",
                    "/srv/samba/schools/uni/program",     
                    "/srv/samba/schools/uni/examusers",
                    "/srv/samba/schools/uni/share/projects",
                    "/srv/samba/schools/uni/students",
                    "/srv/samba/schools/uni/students/12abc",
                    "/srv/samba/schools/uni/share/classes/12abc",
                    "/srv/samba/schools/uni/students/12abc/lordjo72",
                    "/srv/samba/schools/uni/students/12abc/lordjo72/transfer",
#                    "/srv/samba/schools/uni/students/12abc/lordjo72/_einsammeln",
                    "/srv/samba/schools/uni/students/12abc/blackmri72",
                    "/srv/samba/schools/uni/students/12abc/blackmri72/transfer",
#                    "/srv/samba/schools/uni/students/12abc/blackmri72/_einsammeln",
                    "/srv/samba/schools/uni/teachers",
                    "/srv/samba/schools/uni/teachers/kep72",
                    "/srv/samba/schools/uni/teachers/kep72/transfer",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/file1-level1",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/file2-level1",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir1-level1",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir1-level1/file1-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir1-level1/file2-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir1-level1/file3-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/file1-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/file2-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/file3-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/uni/teachers/kep72/_einsammeln",
                    "/srv/samba/schools/uni/teachers/gal72",
                    "/srv/samba/schools/uni/teachers/gal72/transfer",
#                    "/srv/samba/schools/uni/teachers/gal72/_einsammeln",
                    "/srv/samba/schools/uni/share/teachers",
                    "/srv/samba/schools/uni/share/classes",                                      # ntacl
                    "/srv/samba/schools/uni/share/management",                                      # ntacl
                    "/srv/samba/schools/uni/share/school",                                      # ntacl
                    "/srv/samba/schools/default-school",
                    "/srv/samba/schools/default-school/management",
                    "/srv/samba/schools/default-school/share",
                    "/srv/samba/schools/default-school/iso",
                    "/srv/samba/schools/default-school/program",
                    "/srv/samba/schools/default-school/examusers",
                    "/srv/samba/schools/default-school/share/projects",
                    "/srv/samba/schools/default-school/students",
                    "/srv/samba/schools/default-school/students/s6ade",
                    "/srv/samba/schools/default-school/share/classes/s6ade",
                    "/srv/samba/schools/default-school/students/s6ade/schneima72",
                    "/srv/samba/schools/default-school/students/s6ade/schneima72/transfer",
#                    "/srv/samba/schools/default-school/students/s6ade/schneima72/_einsammeln",
                    "/srv/samba/schools/default-school/teachers",
                    "/srv/samba/schools/default-school/teachers/sch72",
                    "/srv/samba/schools/default-school/teachers/sch72/transfer",
#                    "/srv/samba/schools/default-school/teachers/sch72/_einsammeln",
                    "/srv/samba/schools/default-school/share/teachers",
                    "/srv/samba/schools/default-school/share/classes",                           # ntacl
                    "/srv/samba/schools/default-school/share/management",                                      # ntacl
                    "/srv/samba/schools/default-school/share/school",                                      # ntacl
                   ); 
# Testing NTACLs of exam users
    # /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam
    &NTACL_test ("bsz",
                 "/examusers/subdir72/maiersa72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\maiersa72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/subdir72/maiersa72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam
    &NTACL_test ("bsz",
                 "/examusers/subdir72/muellegr72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\muellegr72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/subdir72/muellegr72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/jonsonad72-exam
    &NTACL_test ("bsz",
                 "/examusers/jonsonad72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\jonsonad72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/jonsonad72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/samardze72-exam
    &NTACL_test ("bsz",
                 "/examusers/samardze72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\samardze72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/samardze72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/samardze72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    &end_fs_test(\%fs_test_result);

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result);
    &directory_tree_test("/srv/samba/global",
                         \%fs_test_result,
                         "/srv/samba/global",
                         "/srv/samba/global/management",
                         "/srv/samba/global/share",
                         "/srv/samba/global/program",
                         "/srv/samba/global/iso",
                         "/srv/samba/global/share/projects",
                         "/srv/samba/global/share/management",         # ntacl
                         "/srv/samba/global/share/global",         # ntacl
                         "/srv/samba/global/students",
                         "/srv/samba/global/teachers",
                        ); 
    &end_fs_test(\%fs_test_result);
}



############################################################
# do the file transfer, collect move
############################################################
if ($file_transfer_collect_move==1){
    # move
    # collect dirs and files from default location 'transfer'
    &run_command("sophomorix-transfer $all_options --collect-move --from-user maiersa72 --to-user wu72 --file transfer/file1-level1,transfer/file2-level1,transfer/subdir2-level1");
    # collect the whole directory 'transfer'
    &run_command("sophomorix-transfer $all_options --collect-move --from-user muellegr72-exam --to-user gal72 --file transfer");
}



############################################################
# test the file transfer, collect move
############################################################
if ($test_file_transfer_collect_move==1){
    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result); 
    &directory_tree_test("/srv/samba/schools",
                    \%fs_test_result,
                    "/srv/samba/schools",
                    "/srv/samba/schools/abc",
                    "/srv/samba/schools/lin",
                    "/srv/samba/schools/ghs",
                    "/srv/samba/schools/bsz",
                    "/srv/samba/schools/bsz/management",
                    "/srv/samba/schools/bsz/share",     
                    "/srv/samba/schools/bsz/iso",
                    "/srv/samba/schools/bsz/program",     
                    "/srv/samba/schools/bsz/examusers",
                    "/srv/samba/schools/bsz/examusers/subdir72",
                    "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam",
                    "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer",
#                    "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/file1-level1",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/file2-level1",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir1-level1",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir1-level1/file1-level2",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir1-level1/file2-level2",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir1-level1/file3-level2",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/file1-level2",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/file2-level2",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/file3-level2",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir1-level2",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/file1-level3",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/file2-level3",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir2-level2",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/examusers/jonsonad72-exam",
                    "/srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer",
#                    "/srv/samba/schools/bsz/examusers/jonsonad72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/file1-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/file2-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file1-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file2-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file3-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file1-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file2-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file3-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/examusers/samardze72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/share/projects",
                    "/srv/samba/schools/bsz/students",
                    "/srv/samba/schools/bsz/teachers",
                    "/srv/samba/schools/bsz/teachers/oe72",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/file1-level1",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/file2-level1",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/file1-level2",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/file2-level2",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/file3-level2",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer/maiersa72/transfer/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/teachers/oe72/_einsammeln",
                    "/srv/samba/schools/bsz/teachers/wu72",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer/maiersa72",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer/maiersa72/transfer",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer/maiersa72/transfer/file1-level1",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer/maiersa72/transfer/file2-level1",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer/maiersa72/transfer/subdir2-level1",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer/maiersa72/transfer/subdir2-level1/file1-level2",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer/maiersa72/transfer/subdir2-level1/file2-level2",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer/maiersa72/transfer/subdir2-level1/file3-level2",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer/maiersa72/transfer/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer/maiersa72/transfer/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer/maiersa72/transfer/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer/maiersa72/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer/maiersa72/transfer/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer/maiersa72/transfer/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/teachers/wu72/_einsammeln",
                    "/srv/samba/schools/bsz/share/teachers",
                    "/srv/samba/schools/bsz/share/classes",                                      # ntacl
                    "/srv/samba/schools/bsz/share/management",                                      # ntacl
                    "/srv/samba/schools/bsz/share/school",                                      # ntacl
                    "/srv/samba/schools/bsz/students/m7ab",
                    "/srv/samba/schools/bsz/share/classes/m7ab",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/file1-level1",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/file2-level1",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir1-level1",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir1-level1/file1-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir1-level1/file2-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir1-level1/file3-level2",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/file1-level2",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/file2-level2",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/file3-level2",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir1-level2",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir1-level2/file1-level3",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir1-level2/file2-level3",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir2-level2",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/_einsammeln",
                    "/srv/samba/schools/bsz/students/m7ab/muellegr72",
                    "/srv/samba/schools/bsz/students/m7ab/muellegr72/transfer",
#                    "/srv/samba/schools/bsz/students/m7ab/muellegr72/_einsammeln",
                    "/srv/samba/schools/bsz/students/m8cd",
                    "/srv/samba/schools/bsz/share/classes/m8cd",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/transfer",
#                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/_einsammeln",
                    "/srv/samba/schools/bsz/students/m8cd/samardze72",
                    "/srv/samba/schools/bsz/students/m8cd/samardze72/transfer",
#                    "/srv/samba/schools/bsz/students/m8cd/samardze72/_einsammeln",
                    "/srv/samba/schools/uni",
                    "/srv/samba/schools/uni/management",
                    "/srv/samba/schools/uni/share",     
                    "/srv/samba/schools/uni/iso",
                    "/srv/samba/schools/uni/program",     
                    "/srv/samba/schools/uni/examusers",
                    "/srv/samba/schools/uni/share/projects",
                    "/srv/samba/schools/uni/students",
                    "/srv/samba/schools/uni/students/12abc",
                    "/srv/samba/schools/uni/share/classes/12abc",
                    "/srv/samba/schools/uni/students/12abc/lordjo72",
                    "/srv/samba/schools/uni/students/12abc/lordjo72/transfer",
#                    "/srv/samba/schools/uni/students/12abc/lordjo72/_einsammeln",
                    "/srv/samba/schools/uni/students/12abc/blackmri72",
                    "/srv/samba/schools/uni/students/12abc/blackmri72/transfer",
#                    "/srv/samba/schools/uni/students/12abc/blackmri72/_einsammeln",
                    "/srv/samba/schools/uni/teachers",
                    "/srv/samba/schools/uni/teachers/kep72",
                    "/srv/samba/schools/uni/teachers/kep72/transfer",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/file1-level1",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/file2-level1",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir1-level1",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir1-level1/file1-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir1-level1/file2-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir1-level1/file3-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/file1-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/file2-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/file3-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/uni/teachers/kep72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir3-level2",

#                    "/srv/samba/schools/uni/teachers/kep72/_einsammeln",
                    "/srv/samba/schools/uni/teachers/gal72",
                    "/srv/samba/schools/uni/teachers/gal72/transfer",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/file1-level1",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/file2-level1",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/subdir1-level1",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/subdir1-level1/file1-level2",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/subdir1-level1/file2-level2",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/subdir1-level1/file3-level2",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/subdir2-level1",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/subdir2-level1/file1-level2",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/subdir2-level1/file2-level2",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/subdir2-level1/file3-level2",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/uni/teachers/gal72/transfer/muellegr72-exam/transfer/subdir2-level1/subdir3-level2",



#                    "/srv/samba/schools/uni/teachers/gal72/_einsammeln",
                    "/srv/samba/schools/uni/share/teachers",
                    "/srv/samba/schools/uni/share/classes",                                      # ntacl
                    "/srv/samba/schools/uni/share/management",                                      # ntacl
                    "/srv/samba/schools/uni/share/school",                                      # ntacl
                    "/srv/samba/schools/default-school",
                    "/srv/samba/schools/default-school/management",
                    "/srv/samba/schools/default-school/share",
                    "/srv/samba/schools/default-school/iso",
                    "/srv/samba/schools/default-school/program",
                    "/srv/samba/schools/default-school/examusers",
                    "/srv/samba/schools/default-school/share/projects",
                    "/srv/samba/schools/default-school/students",
                    "/srv/samba/schools/default-school/students/s6ade",
                    "/srv/samba/schools/default-school/share/classes/s6ade",
                    "/srv/samba/schools/default-school/students/s6ade/schneima72",
                    "/srv/samba/schools/default-school/students/s6ade/schneima72/transfer",
#                    "/srv/samba/schools/default-school/students/s6ade/schneima72/_einsammeln",
                    "/srv/samba/schools/default-school/teachers",
                    "/srv/samba/schools/default-school/teachers/sch72",
                    "/srv/samba/schools/default-school/teachers/sch72/transfer",
#                    "/srv/samba/schools/default-school/teachers/sch72/_einsammeln",
                    "/srv/samba/schools/default-school/share/teachers",
                    "/srv/samba/schools/default-school/share/classes",                           # ntacl
                    "/srv/samba/schools/default-school/share/management",                                      # ntacl
                    "/srv/samba/schools/default-school/share/school",                                      # ntacl
                   ); 
# Testing NTACLs of exam users
    # /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam
    &NTACL_test ("bsz",
                 "/examusers/subdir72/maiersa72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\maiersa72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/subdir72/maiersa72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam
    &NTACL_test ("bsz",
                 "/examusers/subdir72/muellegr72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\muellegr72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/subdir72/muellegr72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/jonsonad72-exam
    &NTACL_test ("bsz",
                 "/examusers/jonsonad72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\jonsonad72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/jonsonad72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/samardze72-exam
    &NTACL_test ("bsz",
                 "/examusers/samardze72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\samardze72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/samardze72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/samardze72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    &end_fs_test(\%fs_test_result);

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result);
    &directory_tree_test("/srv/samba/global",
                         \%fs_test_result,
                         "/srv/samba/global",
                         "/srv/samba/global/management",
                         "/srv/samba/global/share",
                         "/srv/samba/global/program",
                         "/srv/samba/global/iso",
                         "/srv/samba/global/share/projects",
                         "/srv/samba/global/share/management",         # ntacl
                         "/srv/samba/global/share/global",         # ntacl
                         "/srv/samba/global/students",
                         "/srv/samba/global/teachers",
                        ); 
    &end_fs_test(\%fs_test_result);
}



############################################################
# do clean up after file transfer
############################################################
if ($file_transfer_clean==1){
    # clean up  files
    &run_command("sophomorix-transfer $all_options --clean-home-dir oe72,muellegr72,kep72,wu72,gal72");
    &run_command("sophomorix-transfer $all_options --clean-transfer-dir maiersa72,muellegr72-exam");
}



############################################################
# test clean up after file transfer
############################################################
if ($test_file_transfer_clean==1){
    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result); 
    &directory_tree_test("/srv/samba/schools",
                         \%fs_test_result,
                         "/srv/samba/schools",
                         "/srv/samba/schools/abc",
                         "/srv/samba/schools/lin",
                         "/srv/samba/schools/ghs",
                         "/srv/samba/schools/bsz",
                         "/srv/samba/schools/bsz/management",
                         "/srv/samba/schools/bsz/share",     
                         "/srv/samba/schools/bsz/iso",
                         "/srv/samba/schools/bsz/program",     
                         "/srv/samba/schools/bsz/examusers",
                         "/srv/samba/schools/bsz/examusers/subdir72",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer",
#                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/_einsammeln",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer",
#                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/_einsammeln",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer",
#                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam/_einsammeln",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/file1-level1",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/file2-level1",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file1-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file2-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file3-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file1-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file2-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file3-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/file1-level3",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/file2-level3",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir2-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir3-level2",
#                         "/srv/samba/schools/bsz/examusers/samardze72-exam/_einsammeln",
                         "/srv/samba/schools/bsz/share/projects",
                         "/srv/samba/schools/bsz/students",
                         "/srv/samba/schools/bsz/teachers",
                         "/srv/samba/schools/bsz/teachers/oe72",
                         "/srv/samba/schools/bsz/teachers/oe72/transfer",
#                         "/srv/samba/schools/bsz/teachers/oe72/_einsammeln",
                         "/srv/samba/schools/bsz/teachers/wu72",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer",
#                         "/srv/samba/schools/bsz/teachers/wu72/_einsammeln",
                         "/srv/samba/schools/bsz/share/teachers",
                         "/srv/samba/schools/bsz/share/classes",                                      # ntacl
                         "/srv/samba/schools/bsz/share/management",                                      # ntacl
                         "/srv/samba/schools/bsz/share/school",                                      # ntacl
                         "/srv/samba/schools/bsz/students/m7ab",
                         "/srv/samba/schools/bsz/share/classes/m7ab",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer",
#                         "/srv/samba/schools/bsz/students/m7ab/maiersa72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72/transfer",
#                         "/srv/samba/schools/bsz/students/m7ab/muellegr72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m8cd",
                         "/srv/samba/schools/bsz/share/classes/m8cd",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/transfer",
#                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72/transfer",
#                         "/srv/samba/schools/bsz/students/m8cd/samardze72/_einsammeln",
                         "/srv/samba/schools/uni",
                         "/srv/samba/schools/uni/management",
                         "/srv/samba/schools/uni/share",     
                         "/srv/samba/schools/uni/iso",
                         "/srv/samba/schools/uni/program",     
                         "/srv/samba/schools/uni/examusers",
                         "/srv/samba/schools/uni/share/projects",
                         "/srv/samba/schools/uni/students",
                         "/srv/samba/schools/uni/students/12abc",
                         "/srv/samba/schools/uni/share/classes/12abc",
                         "/srv/samba/schools/uni/students/12abc/lordjo72",
                         "/srv/samba/schools/uni/students/12abc/lordjo72/transfer",
#                         "/srv/samba/schools/uni/students/12abc/lordjo72/_einsammeln",
                         "/srv/samba/schools/uni/students/12abc/blackmri72",
                         "/srv/samba/schools/uni/students/12abc/blackmri72/transfer",
#                         "/srv/samba/schools/uni/students/12abc/blackmri72/_einsammeln",
                         "/srv/samba/schools/uni/teachers",
                         "/srv/samba/schools/uni/teachers/kep72",
                         "/srv/samba/schools/uni/teachers/kep72/transfer",
#                         "/srv/samba/schools/uni/teachers/kep72/_einsammeln",
                         "/srv/samba/schools/uni/teachers/gal72",
                         "/srv/samba/schools/uni/teachers/gal72/transfer",
#                         "/srv/samba/schools/uni/teachers/gal72/_einsammeln",
                         "/srv/samba/schools/uni/share/teachers",
                         "/srv/samba/schools/uni/share/classes",                                      # ntacl
                         "/srv/samba/schools/uni/share/management",                                      # ntacl
                         "/srv/samba/schools/uni/share/school",                                      # ntacl
                         "/srv/samba/schools/default-school",
                         "/srv/samba/schools/default-school/management",
                         "/srv/samba/schools/default-school/share",
                         "/srv/samba/schools/default-school/iso",
                         "/srv/samba/schools/default-school/program",
                         "/srv/samba/schools/default-school/examusers",
                         "/srv/samba/schools/default-school/share/projects",
                         "/srv/samba/schools/default-school/students",
                         "/srv/samba/schools/default-school/students/s6ade",
                         "/srv/samba/schools/default-school/share/classes/s6ade",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72/transfer",
#                         "/srv/samba/schools/default-school/students/s6ade/schneima72/_einsammeln",
                         "/srv/samba/schools/default-school/teachers",
                         "/srv/samba/schools/default-school/teachers/sch72",
                         "/srv/samba/schools/default-school/teachers/sch72/transfer",
#                         "/srv/samba/schools/default-school/teachers/sch72/_einsammeln",
                         "/srv/samba/schools/default-school/share/teachers",
                         "/srv/samba/schools/default-school/share/classes",                           # ntacl
                         "/srv/samba/schools/default-school/share/management",                                      # ntacl
                         "/srv/samba/schools/default-school/share/school",                                      # ntacl
                        ); 
# Testing NTACLs of exam users
    # /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam
    &NTACL_test ("bsz",
                 "/examusers/subdir72/maiersa72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\maiersa72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/subdir72/maiersa72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam
    &NTACL_test ("bsz",
                 "/examusers/subdir72/muellegr72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\muellegr72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/subdir72/muellegr72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/jonsonad72-exam
    &NTACL_test ("bsz",
                 "/examusers/jonsonad72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\jonsonad72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/jonsonad72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/samardze72-exam
    &NTACL_test ("bsz",
                 "/examusers/samardze72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\samardze72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/samardze72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/samardze72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    &end_fs_test(\%fs_test_result);

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result);
    &directory_tree_test("/srv/samba/global",
                         \%fs_test_result,
                         "/srv/samba/global",
                         "/srv/samba/global/management",
                         "/srv/samba/global/share",
                         "/srv/samba/global/program",
                         "/srv/samba/global/iso",
                         "/srv/samba/global/share/projects",
                         "/srv/samba/global/share/management",         # ntacl
                         "/srv/samba/global/share/global",         # ntacl
                         "/srv/samba/global/students",
                         "/srv/samba/global/teachers",
                        ); 
    &end_fs_test(\%fs_test_result);
}



############################################################
# do the file transfer into home
############################################################
if ($file_transfer_home==1){
    # share files
    &run_command("sophomorix-transfer $all_options --from-unix-path /usr/share/sophomorix-developer/testdata/transfer-testdata --to-user maiersa72,muellegr72-exam --subdir \"\"");
    &run_command("sophomorix-transfer $all_options --from-unix-path /usr/share/sophomorix-developer/testdata/transfer-testdata --to-user jonsonad72 --subdir \"\"");
}



############################################################
# Test the file transfer into home
############################################################
if ($test_file_transfer_home==1){
    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result); 
    &directory_tree_test("/srv/samba/schools",
                    \%fs_test_result,
                    "/srv/samba/schools",
                    "/srv/samba/schools/abc",
                    "/srv/samba/schools/lin",
                    "/srv/samba/schools/ghs",
                    "/srv/samba/schools/bsz",
                    "/srv/samba/schools/bsz/management",
                    "/srv/samba/schools/bsz/share",     
                    "/srv/samba/schools/bsz/iso",
                    "/srv/samba/schools/bsz/program",     
                    "/srv/samba/schools/bsz/examusers",
                    "/srv/samba/schools/bsz/examusers/subdir72",
                    "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam",
                    "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer",
#                    "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/file1-level1",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/file2-level1",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/subdir1-level1",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/subdir1-level1/file1-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/subdir1-level1/file2-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/subdir1-level1/file3-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/subdir2-level1",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/subdir2-level1/file1-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/subdir2-level1/file2-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/subdir2-level1/file3-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/subdir2-level1/subdir3-level2",


#                    "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/examusers/jonsonad72-exam",
                    "/srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer",
#                    "/srv/samba/schools/bsz/examusers/jonsonad72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/file1-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/file2-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file1-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file2-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file3-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file1-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file2-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file3-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/examusers/samardze72-exam/_einsammeln",
                    "/srv/samba/schools/bsz/share/projects",
                    "/srv/samba/schools/bsz/students",
                    "/srv/samba/schools/bsz/teachers",
                    "/srv/samba/schools/bsz/teachers/oe72",
                    "/srv/samba/schools/bsz/teachers/oe72/transfer",
#                    "/srv/samba/schools/bsz/teachers/oe72/_einsammeln",
                    "/srv/samba/schools/bsz/teachers/wu72",
                    "/srv/samba/schools/bsz/teachers/wu72/transfer",

#                    "/srv/samba/schools/bsz/teachers/wu72/_einsammeln",
                    "/srv/samba/schools/bsz/share/teachers",
                    "/srv/samba/schools/bsz/share/classes",                                      # ntacl
                    "/srv/samba/schools/bsz/share/management",                                      # ntacl
                    "/srv/samba/schools/bsz/share/school",                                      # ntacl
                    "/srv/samba/schools/bsz/students/m7ab",
                    "/srv/samba/schools/bsz/share/classes/m7ab",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/file1-level1",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/file2-level1",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/subdir1-level1",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/subdir1-level1/file1-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/subdir1-level1/file2-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/subdir1-level1/file3-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/subdir2-level1",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/subdir2-level1/file1-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/subdir2-level1/file2-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/subdir2-level1/file3-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/students/m7ab/maiersa72/_einsammeln",
                    "/srv/samba/schools/bsz/students/m7ab/muellegr72",
                    "/srv/samba/schools/bsz/students/m7ab/muellegr72/transfer",
#                    "/srv/samba/schools/bsz/students/m7ab/muellegr72/_einsammeln",
                    "/srv/samba/schools/bsz/students/m8cd",
                    "/srv/samba/schools/bsz/share/classes/m8cd",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/transfer",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/file1-level1",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/file2-level1",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir1-level1",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir1-level1/file1-level2",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir1-level1/file2-level2",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir1-level1/file3-level2",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/file1-level2",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/file2-level2",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/file3-level2",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir1-level2",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir1-level2/file1-level3",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir1-level2/file2-level3",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir1-level2/subdir1-level3",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir2-level2",
                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir3-level2",
#                    "/srv/samba/schools/bsz/students/m8cd/jonsonad72/_einsammeln",
                    "/srv/samba/schools/bsz/students/m8cd/samardze72",
                    "/srv/samba/schools/bsz/students/m8cd/samardze72/transfer",
#                    "/srv/samba/schools/bsz/students/m8cd/samardze72/_einsammeln",
                    "/srv/samba/schools/uni",
                    "/srv/samba/schools/uni/management",
                    "/srv/samba/schools/uni/share",     
                    "/srv/samba/schools/uni/iso",
                    "/srv/samba/schools/uni/program",     
                    "/srv/samba/schools/uni/examusers",
                    "/srv/samba/schools/uni/share/projects",
                    "/srv/samba/schools/uni/students",
                    "/srv/samba/schools/uni/students/12abc",
                    "/srv/samba/schools/uni/share/classes/12abc",
                    "/srv/samba/schools/uni/students/12abc/lordjo72",
                    "/srv/samba/schools/uni/students/12abc/lordjo72/transfer",
#                    "/srv/samba/schools/uni/students/12abc/lordjo72/_einsammeln",
                    "/srv/samba/schools/uni/students/12abc/blackmri72",
                    "/srv/samba/schools/uni/students/12abc/blackmri72/transfer",
#                    "/srv/samba/schools/uni/students/12abc/blackmri72/_einsammeln",
                    "/srv/samba/schools/uni/teachers",
                    "/srv/samba/schools/uni/teachers/kep72",
                    "/srv/samba/schools/uni/teachers/kep72/transfer",
#                    "/srv/samba/schools/uni/teachers/kep72/_einsammeln",
                    "/srv/samba/schools/uni/teachers/gal72",
                    "/srv/samba/schools/uni/teachers/gal72/transfer",
#                    "/srv/samba/schools/uni/teachers/gal72/_einsammeln",
                    "/srv/samba/schools/uni/share/teachers",
                    "/srv/samba/schools/uni/share/classes",                                      # ntacl
                    "/srv/samba/schools/uni/share/management",                                      # ntacl
                    "/srv/samba/schools/uni/share/school",                                      # ntacl
                    "/srv/samba/schools/default-school",
                    "/srv/samba/schools/default-school/management",
                    "/srv/samba/schools/default-school/share",
                    "/srv/samba/schools/default-school/iso",
                    "/srv/samba/schools/default-school/program",
                    "/srv/samba/schools/default-school/examusers",
                    "/srv/samba/schools/default-school/share/projects",
                    "/srv/samba/schools/default-school/students",
                    "/srv/samba/schools/default-school/students/s6ade",
                    "/srv/samba/schools/default-school/share/classes/s6ade",
                    "/srv/samba/schools/default-school/students/s6ade/schneima72",
                    "/srv/samba/schools/default-school/students/s6ade/schneima72/transfer",
#                    "/srv/samba/schools/default-school/students/s6ade/schneima72/_einsammeln",
                    "/srv/samba/schools/default-school/teachers",
                    "/srv/samba/schools/default-school/teachers/sch72",
                    "/srv/samba/schools/default-school/teachers/sch72/transfer",
#                    "/srv/samba/schools/default-school/teachers/sch72/_einsammeln",
                    "/srv/samba/schools/default-school/share/teachers",
                    "/srv/samba/schools/default-school/share/classes",                           # ntacl
                    "/srv/samba/schools/default-school/share/management",                                      # ntacl
                    "/srv/samba/schools/default-school/share/school",                                      # ntacl
                   ); 
# Testing NTACLs of exam users
    # /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam
    &NTACL_test ("bsz",
                 "/examusers/subdir72/maiersa72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\maiersa72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/subdir72/maiersa72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam
    &NTACL_test ("bsz",
                 "/examusers/subdir72/muellegr72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\muellegr72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/subdir72/muellegr72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/jonsonad72-exam
    &NTACL_test ("bsz",
                 "/examusers/jonsonad72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\jonsonad72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/jonsonad72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/samardze72-exam
    &NTACL_test ("bsz",
                 "/examusers/samardze72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\samardze72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/samardze72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/samardze72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    &end_fs_test(\%fs_test_result);

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result);
    &directory_tree_test("/srv/samba/global",
                         \%fs_test_result,
                         "/srv/samba/global",
                         "/srv/samba/global/management",
                         "/srv/samba/global/share",
                         "/srv/samba/global/program",
                         "/srv/samba/global/iso",
                         "/srv/samba/global/share/projects",
                         "/srv/samba/global/share/management",         # ntacl
                         "/srv/samba/global/share/global",         # ntacl
                         "/srv/samba/global/students",
                         "/srv/samba/global/teachers",
                        ); 
    &end_fs_test(\%fs_test_result);


}



############################################################
#  do clean up after file transfer into home
############################################################
if ($file_transfer_home_clean==1){
    # clean up  files
    &run_command("sophomorix-transfer $all_options --clean-home-dir maiersa72,muellegr72-exam");
}



############################################################
# test clean up after file transfer into home
############################################################
if ($test_file_transfer_home_clean==1){
    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result); 
    &directory_tree_test("/srv/samba/schools",
                         \%fs_test_result,
                         "/srv/samba/schools",
                         "/srv/samba/schools/abc",
                         "/srv/samba/schools/lin",
                         "/srv/samba/schools/ghs",
                         "/srv/samba/schools/bsz",
                         "/srv/samba/schools/bsz/management",
                         "/srv/samba/schools/bsz/share",     
                         "/srv/samba/schools/bsz/iso",
                         "/srv/samba/schools/bsz/program",     
                         "/srv/samba/schools/bsz/examusers",
                         "/srv/samba/schools/bsz/examusers/subdir72",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam",
                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer",
#                         "/srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/_einsammeln",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam",
                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer",
#                         "/srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/_einsammeln",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam",
                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer",
#                         "/srv/samba/schools/bsz/examusers/jonsonad72-exam/_einsammeln",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/file1-level1",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/file2-level1",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file1-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file2-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir1-level1/file3-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file1-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file2-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/file3-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/file1-level3",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/file2-level3",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir2-level2",
                         "/srv/samba/schools/bsz/examusers/samardze72-exam/transfer/subdir2-level1/subdir3-level2",
#                         "/srv/samba/schools/bsz/examusers/samardze72-exam/_einsammeln",
                         "/srv/samba/schools/bsz/share/projects",
                         "/srv/samba/schools/bsz/students",
                         "/srv/samba/schools/bsz/teachers",
                         "/srv/samba/schools/bsz/teachers/oe72",
                         "/srv/samba/schools/bsz/teachers/oe72/transfer",
#                         "/srv/samba/schools/bsz/teachers/oe72/_einsammeln",
                         "/srv/samba/schools/bsz/teachers/wu72",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer",
#                         "/srv/samba/schools/bsz/teachers/wu72/_einsammeln",
                         "/srv/samba/schools/bsz/share/teachers",
                         "/srv/samba/schools/bsz/share/classes",                                      # ntacl
                         "/srv/samba/schools/bsz/share/management",                                      # ntacl
                         "/srv/samba/schools/bsz/share/school",                                      # ntacl
                         "/srv/samba/schools/bsz/students/m7ab",
                         "/srv/samba/schools/bsz/share/classes/m7ab",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer",
#                         "/srv/samba/schools/bsz/students/m7ab/maiersa72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72/transfer",
#                         "/srv/samba/schools/bsz/students/m7ab/muellegr72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m8cd",
                         "/srv/samba/schools/bsz/share/classes/m8cd",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/transfer",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/file1-level1",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/file2-level1",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir1-level1",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir1-level1/file1-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir1-level1/file2-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir1-level1/file3-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/file1-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/file2-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/file3-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir1-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir1-level2/file1-level3",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir1-level2/file2-level3",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir1-level2/subdir1-level3",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir2-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir3-level2",
#                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72/transfer",
#                         "/srv/samba/schools/bsz/students/m8cd/samardze72/_einsammeln",
                         "/srv/samba/schools/uni",
                         "/srv/samba/schools/uni/management",
                         "/srv/samba/schools/uni/share",     
                         "/srv/samba/schools/uni/iso",
                         "/srv/samba/schools/uni/program",     
                         "/srv/samba/schools/uni/examusers",
                         "/srv/samba/schools/uni/share/projects",
                         "/srv/samba/schools/uni/students",
                         "/srv/samba/schools/uni/students/12abc",
                         "/srv/samba/schools/uni/share/classes/12abc",
                         "/srv/samba/schools/uni/students/12abc/lordjo72",
                         "/srv/samba/schools/uni/students/12abc/lordjo72/transfer",
#                         "/srv/samba/schools/uni/students/12abc/lordjo72/_einsammeln",
                         "/srv/samba/schools/uni/students/12abc/blackmri72",
                         "/srv/samba/schools/uni/students/12abc/blackmri72/transfer",
#                         "/srv/samba/schools/uni/students/12abc/blackmri72/_einsammeln",
                         "/srv/samba/schools/uni/teachers",
                         "/srv/samba/schools/uni/teachers/kep72",
                         "/srv/samba/schools/uni/teachers/kep72/transfer",
#                         "/srv/samba/schools/uni/teachers/kep72/_einsammeln",
                         "/srv/samba/schools/uni/teachers/gal72",
                         "/srv/samba/schools/uni/teachers/gal72/transfer",
#                         "/srv/samba/schools/uni/teachers/gal72/_einsammeln",
                         "/srv/samba/schools/uni/share/teachers",
                         "/srv/samba/schools/uni/share/classes",                                      # ntacl
                         "/srv/samba/schools/uni/share/management",                                      # ntacl
                         "/srv/samba/schools/uni/share/school",                                      # ntacl
                         "/srv/samba/schools/default-school",
                         "/srv/samba/schools/default-school/management",
                         "/srv/samba/schools/default-school/share",
                         "/srv/samba/schools/default-school/iso",
                         "/srv/samba/schools/default-school/program",
                         "/srv/samba/schools/default-school/examusers",
                         "/srv/samba/schools/default-school/share/projects",
                         "/srv/samba/schools/default-school/students",
                         "/srv/samba/schools/default-school/students/s6ade",
                         "/srv/samba/schools/default-school/share/classes/s6ade",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72/transfer",
#                         "/srv/samba/schools/default-school/students/s6ade/schneima72/_einsammeln",
                         "/srv/samba/schools/default-school/teachers",
                         "/srv/samba/schools/default-school/teachers/sch72",
                         "/srv/samba/schools/default-school/teachers/sch72/transfer",
#                         "/srv/samba/schools/default-school/teachers/sch72/_einsammeln",
                         "/srv/samba/schools/default-school/share/teachers",
                         "/srv/samba/schools/default-school/share/classes",                           # ntacl
                         "/srv/samba/schools/default-school/share/management",                                      # ntacl
                         "/srv/samba/schools/default-school/share/school",                                      # ntacl
                        ); 
# Testing NTACLs of exam users
    # /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam
    &NTACL_test ("bsz",
                 "/examusers/subdir72/maiersa72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\maiersa72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/maiersa72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/subdir72/maiersa72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\maiersa72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam
    &NTACL_test ("bsz",
                 "/examusers/subdir72/muellegr72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\muellegr72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/subdir72/muellegr72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/subdir72/muellegr72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\muellegr72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/jonsonad72-exam
    &NTACL_test ("bsz",
                 "/examusers/jonsonad72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\jonsonad72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/jonsonad72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/jonsonad72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\jonsonad72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/samardze72-exam
    &NTACL_test ("bsz",
                 "/examusers/samardze72-exam",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:LINUXMUSTER\samardze72-exam', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/0x0/READ',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI|I/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    # /srv/samba/schools/bsz/examusers/samardze72-exam/transfer
    &NTACL_test ("bsz",
                 "/examusers/samardze72-exam/transfer",
                 $root_dns,
                 $smb_admin_pass,
                 \%fs_test_result,
                 "REVISION:1",
                 "CONTROL:SR|DP",
                 'OWNER:BUILTIN\Administrators', 
                 'GROUP:LINUXMUSTER\Domain Users',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/0x0/RWX',
                 'ACL:LINUXMUSTER\samardze72-exam:ALLOWED/OI|CI|IO/FULL', 
                 'ACL:LINUXMUSTER\bsz-admins:ALLOWED/OI|CI/FULL', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/0x0/RWX', 
                 'ACL:LINUXMUSTER\bsz-teachers:ALLOWED/OI|CI|IO/FULL', 
                );
    &end_fs_test(\%fs_test_result);

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result);
    &directory_tree_test("/srv/samba/global",
                         \%fs_test_result,
                         "/srv/samba/global",
                         "/srv/samba/global/management",
                         "/srv/samba/global/share",
                         "/srv/samba/global/program",
                         "/srv/samba/global/iso",
                         "/srv/samba/global/share/projects",
                         "/srv/samba/global/share/management",         # ntacl
                         "/srv/samba/global/share/global",         # ntacl
                         "/srv/samba/global/students",
                         "/srv/samba/global/teachers",
                        ); 
    &end_fs_test(\%fs_test_result);
}


############################################################
# users NOT in exammode anymore
############################################################
if ($nonexammode_users==1){
    
    # remove the session members in exammode
    # 666
    &run_command("sophomorix-exam-mode --unset --participants maiersa72,muellegr72 --subdir transfer/666 $all_options");
    # 777
    &run_command("sophomorix-exam-mode --unset --participants jonsonad72,samardze72 --subdir transfer/777 $all_options");
}



############################################################
# Test users NOT in exammode
############################################################
if ($test_nonexammode_users==1){
    ##### Testing the users
    # maiersa72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=maiersa72,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Sarina Maier",
                   givenName=>"Sarina",
                   name=>"maiersa72",
                   sAMAccountname=>"maiersa72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\maiersa72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/students/m7ab/maiersa72",
                   sn=>"Maier",
                   userPrincipalName => "maiersa72@".$root_dns,
                   mail => "maiersa72@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Sarina",
                   sophomorixSurnameASCII  => "Maier",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.students.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid1234",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m7ab,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m7ab",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   mail => "bsz-m7ab@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   mail => "bsz-students@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-students",
                  });


    # muellegr72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=muellegr72,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Gregor Müller",
                   givenName=>"Gregor",
                   name=>"muellegr72",
                   sAMAccountname=>"muellegr72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m7ab\\muellegr72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/students/m7ab/muellegr72",
                   sn=>"Müller",
                   userPrincipalName => "muellegr72@".$root_dns,
                   mail => "muellegr72@".$root_dns,
                   sophomorixAdminClass => "bsz-m7ab",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster72!",
                   sophomorixFirstnameASCII => "Gregor",
                   sophomorixSurnameASCII  => "Mueller",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.students.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid2345",
                   userAccountControl => "512",
                   memberOf => "bsz-m7ab|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m7ab,OU=m7ab,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m7ab",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   mail => "bsz-m7ab@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   mail => "bsz-students@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-students",
                  });


    # jonsonad72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=jonsonad72,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Aðalráður Jónsson",
                   givenName=>"Aðalráður",
                   name=>"jonsonad72",
                   sAMAccountname=>"jonsonad72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m8cd\\jonsonad72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                   sn=>"Jónsson",
                   userPrincipalName => "jonsonad72@".$root_dns,
                   mail => "jonsonad72@".$root_dns,
                   sophomorixAdminClass => "bsz-m8cd",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster72!",
                   sophomorixFirstnameASCII => "Adalradur",
                   sophomorixSurnameASCII  => "Jonsson",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.students.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid3456",
                   userAccountControl => "512",
                   memberOf => "bsz-m8cd|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m8cd,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m8cd",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   mail => "bsz-m8cd@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   mail => "bsz-students@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-students",
                  });


    # samardze72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=samardze72,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Željko Samardžić",
                   givenName=>"Željko",
                   name=>"samardze72",
                   sAMAccountname=>"samardze72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\students\\m8cd\\samardze72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/students/m8cd/samardze72",
                   sn=>"Samardžić",
                   userPrincipalName => "samardze72@".$root_dns,
                   mail => "samardze72@".$root_dns,
                   sophomorixAdminClass => "bsz-m8cd",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "Muster!",
                   sophomorixFirstnameASCII => "Zeljko",
                   sophomorixSurnameASCII  => "Samardzic",
                   sophomorixRole => "student",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.students.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid4567",
                   userAccountControl => "512",
                   memberOf => "bsz-m8cd|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "",
                  });
    ##### Testing the users class
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-m8cd,OU=m8cd,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-m8cd",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"adminclass",
                   mail => "bsz-m8cd@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz-students",
                  });
    ##### Testing the users ou-students group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-students,OU=Students,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-students",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"ouclass",
                   mail => "bsz-students@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-students",
                  });


    # oe72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=oe72,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Gökhan Ömür",
                   givenName=>"Gökhan",
                   name=>"oe72",
                   sAMAccountname=>"oe72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\teachers\\oe72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/teachers/oe72",
                   sn=>"Ömür",
                   userPrincipalName => "oe72@".$root_dns,
                   mail => "oe72@".$root_dns,
                   sophomorixAdminClass => "bsz-teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster72!",
                   sophomorixFirstnameASCII => "Goekhan",
                   sophomorixSurnameASCII  => "Oemuer",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.teachers.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid5678",
                   userAccountControl => "512",
                   memberOf => "bsz-teachers|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "666;;muellegr72,maiersa72;",
                  });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-teachers,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   mail => "bsz-teachers@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-teachers",
                  });


    # wu72
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=wu72,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   #####
                   displayName=>"Désirée Würth",
                   givenName=>"Désirée",
                   name=>"wu72",
                   sAMAccountname=>"wu72",
                   uidNumber=>"-1",
                   homeDrive=>"H:",
                   homeDirectory=>"\\\\linuxmuster.local\\bsz\\teachers\\wu72",
                   unixHomeDirectory=>"/srv/samba/schools/bsz/teachers/wu72",
                   sn=>"Würth",
                   userPrincipalName => "wu72@".$root_dns,
                   mail => "wu72@".$root_dns,
                   sophomorixAdminClass => "bsz-teachers",
                   sophomorixExitAdminClass => "unknown",
                   sophomorixFirstPassword => "LinuxMuster!",
                   sophomorixFirstnameASCII => "Desiree",
                   sophomorixSurnameASCII  => "Wuerth",
                   sophomorixRole => "teacher",
                   sophomorixSchoolPrefix => "bsz",
                   sophomorixSchoolname => "bsz",
                   sophomorixAdminFile => "bsz.teachers.csv",
                   sophomorixCreationDate => "exists",
                   sophomorixTolerationDate => "default",
                   sophomorixDeactivationDate => "default",
                   sophomorixComment => "created by sophomorix",
                   sophomorixExamMode => "---",
                   sophomorixStatus=>"U",
                   sophomorixUnid => "unid6789",
                   userAccountControl => "512",
                   memberOf => "bsz-teachers|bsz-wifi|bsz-internet|bsz-webfilter|bsz-intranet|bsz-printing",
                   sophomorixSessions => "777;;jonsonad72,samardze72;|888;Monday session;muellegr72,samardze72;",
                  });
    ##### Testing the users ou-teachers group
    &AD_test_object({ldap=>$ldap,
                   dn=>"CN=bsz-teachers,OU=Teachers,OU=bsz,OU=SCHOOLS,".$root_dse,
                   sAMAccountname=>"bsz-teachers",
                   gidNumber=>"-1",
                   sophomorixCreationDate => "exists",
                   sophomorixStatus=>"P",
                   sophomorixType=>"teacherclass",
                   mail => "bsz-teachers@".$root_dns,
                   sophomorixHidden=>"FALSE",
                   sophomorixSchoolname => "bsz",
                   memberOf => "bsz|all-teachers",
                  });

    # check if examuser are deleted
    &AD_object_nonexist($ldap,$root_dse,"user","maiersa72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","muellegr72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","jonsonad72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","samardze72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","oe72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","wu72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","lordjo72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","blackmri72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","kep72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","gal72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","schneima72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","sch72-exam");
   
    ############################################################
    # check if homes of examusers are deleted
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result); 
    &directory_tree_test("/srv/samba/schools",
                         \%fs_test_result,
                         "/srv/samba/schools",
                         "/srv/samba/schools/abc",
                         "/srv/samba/schools/lin",
                         "/srv/samba/schools/ghs",
                         "/srv/samba/schools/bsz",
                         "/srv/samba/schools/bsz/management",
                         "/srv/samba/schools/bsz/share",     
                         "/srv/samba/schools/bsz/iso",
                         "/srv/samba/schools/bsz/program",     
                         "/srv/samba/schools/bsz/examusers",
                         "/srv/samba/schools/bsz/share/projects",
                         "/srv/samba/schools/bsz/students",
                         "/srv/samba/schools/bsz/teachers",
                         "/srv/samba/schools/bsz/teachers/oe72",
                         "/srv/samba/schools/bsz/teachers/oe72/transfer",
                         "/srv/samba/schools/bsz/teachers/oe72/transfer/666",
                         "/srv/samba/schools/bsz/teachers/oe72/transfer/666/maiersa72-exam",
                         "/srv/samba/schools/bsz/teachers/oe72/transfer/666/maiersa72-exam/transfer",
                         "/srv/samba/schools/bsz/teachers/oe72/transfer/666/muellegr72-exam",
                         "/srv/samba/schools/bsz/teachers/oe72/transfer/666/muellegr72-exam/transfer",
#                         "/srv/samba/schools/bsz/teachers/oe72/_einsammeln",
                         "/srv/samba/schools/bsz/teachers/wu72",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/jonsonad72-exam",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/jonsonad72-exam/transfer",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer",

                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/file1-level1",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/file2-level1",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/subdir1-level1",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/subdir1-level1/file1-level2",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/subdir1-level1/file2-level2",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/subdir1-level1/file3-level2",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/subdir2-level1",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/subdir2-level1/file1-level2",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/subdir2-level1/file2-level2",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/subdir2-level1/file3-level2",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/subdir2-level1/subdir1-level2",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/subdir2-level1/subdir1-level2/file1-level3",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/subdir2-level1/subdir1-level2/file2-level3",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/subdir2-level1/subdir1-level2/subdir1-level3",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/subdir2-level1/subdir2-level2",
                         "/srv/samba/schools/bsz/teachers/wu72/transfer/777/samardze72-exam/transfer/subdir2-level1/subdir3-level2",



#                         "/srv/samba/schools/bsz/teachers/wu72/_einsammeln",
                         "/srv/samba/schools/bsz/share/teachers",
                         "/srv/samba/schools/bsz/share/classes",                                      # ntacl
                         "/srv/samba/schools/bsz/share/management",                                      # ntacl
                         "/srv/samba/schools/bsz/share/school",                                      # ntacl
                         "/srv/samba/schools/bsz/students/m7ab",
                         "/srv/samba/schools/bsz/share/classes/m7ab",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72",
                         "/srv/samba/schools/bsz/students/m7ab/maiersa72/transfer",
#                         "/srv/samba/schools/bsz/students/m7ab/maiersa72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72",
                         "/srv/samba/schools/bsz/students/m7ab/muellegr72/transfer",
#                         "/srv/samba/schools/bsz/students/m7ab/muellegr72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m8cd",
                         "/srv/samba/schools/bsz/share/classes/m8cd",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/transfer",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/file1-level1",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/file2-level1",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir1-level1",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir1-level1/file1-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir1-level1/file2-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir1-level1/file3-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/file1-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/file2-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/file3-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir1-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir1-level2/file1-level3",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir1-level2/file2-level3",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir1-level2/subdir1-level3",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir2-level2",
                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/subdir2-level1/subdir3-level2",
#                         "/srv/samba/schools/bsz/students/m8cd/jonsonad72/_einsammeln",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72",
                         "/srv/samba/schools/bsz/students/m8cd/samardze72/transfer",
#                         "/srv/samba/schools/bsz/students/m8cd/samardze72/_einsammeln",
                         "/srv/samba/schools/uni",
                         "/srv/samba/schools/uni/management",
                         "/srv/samba/schools/uni/share",     
                         "/srv/samba/schools/uni/iso",
                         "/srv/samba/schools/uni/program",     
                         "/srv/samba/schools/uni/examusers",
                         "/srv/samba/schools/uni/share/projects",
                         "/srv/samba/schools/uni/students",
                         "/srv/samba/schools/uni/students/12abc",
                         "/srv/samba/schools/uni/share/classes/12abc",
                         "/srv/samba/schools/uni/students/12abc/lordjo72",
                         "/srv/samba/schools/uni/students/12abc/lordjo72/transfer",
#                         "/srv/samba/schools/uni/students/12abc/lordjo72/_einsammeln",
                         "/srv/samba/schools/uni/students/12abc/blackmri72",
                         "/srv/samba/schools/uni/students/12abc/blackmri72/transfer",
#                         "/srv/samba/schools/uni/students/12abc/blackmri72/_einsammeln",
                         "/srv/samba/schools/uni/teachers",
                         "/srv/samba/schools/uni/teachers/kep72",
                         "/srv/samba/schools/uni/teachers/kep72/transfer",
#                         "/srv/samba/schools/uni/teachers/kep72/_einsammeln",
                         "/srv/samba/schools/uni/teachers/gal72",
                         "/srv/samba/schools/uni/teachers/gal72/transfer",
#                         "/srv/samba/schools/uni/teachers/gal72/_einsammeln",
                         "/srv/samba/schools/uni/share/teachers",
                         "/srv/samba/schools/uni/share/classes",                                      # ntacl
                         "/srv/samba/schools/uni/share/management",                                      # ntacl
                         "/srv/samba/schools/uni/share/school",                                      # ntacl
                         "/srv/samba/schools/default-school",
                         "/srv/samba/schools/default-school/management",
                         "/srv/samba/schools/default-school/share",
                         "/srv/samba/schools/default-school/iso",
                         "/srv/samba/schools/default-school/program",
                         "/srv/samba/schools/default-school/examusers",
                         "/srv/samba/schools/default-school/share/projects",
                         "/srv/samba/schools/default-school/students",
                         "/srv/samba/schools/default-school/students/s6ade",
                         "/srv/samba/schools/default-school/share/classes/s6ade",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72",
                         "/srv/samba/schools/default-school/students/s6ade/schneima72/transfer",
#                         "/srv/samba/schools/default-school/students/s6ade/schneima72/_einsammeln",
                         "/srv/samba/schools/default-school/teachers",
                         "/srv/samba/schools/default-school/teachers/sch72",
                         "/srv/samba/schools/default-school/teachers/sch72/transfer",
#                         "/srv/samba/schools/default-school/teachers/sch72/_einsammeln",
                         "/srv/samba/schools/default-school/share/teachers",
                         "/srv/samba/schools/default-school/share/classes",                           # ntacl
                         "/srv/samba/schools/default-school/share/management",                                      # ntacl
                         "/srv/samba/schools/default-school/share/school",                                      # ntacl
                        ); 
    &end_fs_test(\%fs_test_result);

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result);
    &directory_tree_test("/srv/samba/global",
                         \%fs_test_result,
                         "/srv/samba/global",
                         "/srv/samba/global/management",
                         "/srv/samba/global/share",
                         "/srv/samba/global/program",
                         "/srv/samba/global/iso",
                         "/srv/samba/global/share/projects",
                         "/srv/samba/global/share/management",         # ntacl
                         "/srv/samba/global/share/global",         # ntacl
                         "/srv/samba/global/students",
                         "/srv/samba/global/teachers",
                        ); 
    &end_fs_test(\%fs_test_result);
}








############################################################
# Kill Users and classes
############################################################
# --kill-users  
if ($kill_users==1){
    &run_command("cp -v $file_kill_users $file_kill");
    &run_command("sophomorix-kill -i $all_options");
    &run_command("sophomorix-kill $all_options");

    # classes
    &run_command("sophomorix-class --kill --class bsz-m7ab $all_options");
    &run_command("sophomorix-class --kill --class bsz-m8cd $all_options");
    &run_command("sophomorix-class --kill --class s6ade $all_options");
    &run_command("sophomorix-class --kill --class uni-12abc $all_options");
}


############################################################
#  Test killed  users, groups
############################################################
# --test-kill-users  
if ($test_kill_users==1){
    # users
    &AD_object_nonexist($ldap,$root_dse,"user","maiersa72");
    &AD_object_nonexist($ldap,$root_dse,"user","muellegr72");
    &AD_object_nonexist($ldap,$root_dse,"user","jonsonad72");
    &AD_object_nonexist($ldap,$root_dse,"user","samardze72");
    &AD_object_nonexist($ldap,$root_dse,"user","oe72");
    &AD_object_nonexist($ldap,$root_dse,"user","wu72");
    &AD_object_nonexist($ldap,$root_dse,"user","lordjo72");
    &AD_object_nonexist($ldap,$root_dse,"user","blackmri72");
    &AD_object_nonexist($ldap,$root_dse,"user","kep72");
    &AD_object_nonexist($ldap,$root_dse,"user","gal72");
    &AD_object_nonexist($ldap,$root_dse,"user","schneima72");
    &AD_object_nonexist($ldap,$root_dse,"user","sch72");

    &AD_object_nonexist($ldap,$root_dse,"user","maiersa72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","muellegr72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","jonsonad72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","samardze72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","oe72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","wu72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","lordjo72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","blackmri72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","kep72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","gal72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","schneima72-exam");
    &AD_object_nonexist($ldap,$root_dse,"user","sch72-exam");

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result);
    &directory_tree_test("/srv/samba/schools",
                         \%fs_test_result,
                         "/srv/samba/schools",
                         "/srv/samba/schools/abc",
                         "/srv/samba/schools/lin",
                         "/srv/samba/schools/ghs",
                         "/srv/samba/schools/bsz",
                         "/srv/samba/schools/bsz/management",
                         "/srv/samba/schools/bsz/share",     
                         "/srv/samba/schools/bsz/iso",
                         "/srv/samba/schools/bsz/program",     
                         "/srv/samba/schools/bsz/examusers",
                         "/srv/samba/schools/bsz/share/projects",
                         "/srv/samba/schools/bsz/students",
                         "/srv/samba/schools/bsz/teachers",
                         "/srv/samba/schools/bsz/share/teachers",
                         "/srv/samba/schools/bsz/share/classes",                                      # ntacl
                         "/srv/samba/schools/bsz/share/management",                                      # ntacl
                         "/srv/samba/schools/bsz/share/school",                                      # ntacl
                         "/srv/samba/schools/uni",
                         "/srv/samba/schools/uni/management",
                         "/srv/samba/schools/uni/share",     
                         "/srv/samba/schools/uni/iso",
                         "/srv/samba/schools/uni/program",     
                         "/srv/samba/schools/uni/examusers",
                         "/srv/samba/schools/uni/share/projects",
                         "/srv/samba/schools/uni/students",
                         "/srv/samba/schools/uni/teachers",
                         "/srv/samba/schools/uni/share/teachers",
                         "/srv/samba/schools/uni/share/classes",                                      # ntacl
                         "/srv/samba/schools/uni/share/management",                                      # ntacl
                         "/srv/samba/schools/uni/share/school",                                      # ntacl
                         "/srv/samba/schools/default-school",
                         "/srv/samba/schools/default-school/management",
                         "/srv/samba/schools/default-school/share",
                         "/srv/samba/schools/default-school/iso",
                         "/srv/samba/schools/default-school/program",
                         "/srv/samba/schools/default-school/examusers",
                         "/srv/samba/schools/default-school/share/projects",
                         "/srv/samba/schools/default-school/students",
                         "/srv/samba/schools/default-school/teachers",
                         "/srv/samba/schools/default-school/share/teachers",
                         "/srv/samba/schools/default-school/share/classes",                           # ntacl
                         "/srv/samba/schools/default-school/share/management",                                      # ntacl
                         "/srv/samba/schools/default-school/share/school",                                      # ntacl
                        ); 
    &end_fs_test(\%fs_test_result);

    ############################################################
    # fs test
    ############################################################
    &start_fs_test(\%fs_test_result);
    &directory_tree_test("/srv/samba/global",
                         \%fs_test_result,
                         "/srv/samba/global",
                         "/srv/samba/global/management",
                         "/srv/samba/global/share",
                         "/srv/samba/global/program",
                         "/srv/samba/global/iso",
                         "/srv/samba/global/share/projects",
                         "/srv/samba/global/share/management",         # ntacl
                         "/srv/samba/global/share/global",         # ntacl
                         "/srv/samba/global/students",
                         "/srv/samba/global/teachers",
                        ); 
    &end_fs_test(\%fs_test_result);
}


&AD_unbind_admin($ldap);
